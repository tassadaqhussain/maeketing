!function(t,e,s){"use strict";function a(t){var e,a=s("#tm_epo_consent_for_transmit");a.length&&a.is(":checked")&&0===w&&(w=1,s(".tm-license-button").block({message:null,overlayCSS:{background:"#fff url("+v.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}}),e={action:"tm_"+t+"_license",username:s("#tm_epo_envato_username").val(),key:s("#tm_epo_envato_purchasecode").val(),api_key:s("#tm_epo_envato_apikey").val(),security:v.settings_nonce},s.post(v.ajax_url,e,function(t){var e;e=t&&-1!==t?t&&t.message&&t.result&&("-3"===t.result||"-2"===t.result||"wp_error"===t.result||"server_error"===t.result)?t.message:t&&t.message&&t.result&&"4"===t.result?t.message:"":v.i18n_invalid_request,s(".tm-license-result").html(e),s(".tm-license-button").unblock()},"json").always(function(e){s(".tm-license-button").unblock(),w=0,e&&e.result&&"4"===e.result&&("activate"===t&&(s(".tm-deactivate-license").removeClass("tm-hidden"),s(".tm-activate-license").removeClass("tm-hidden").addClass("tm-hidden")),"deactivate"===t&&(s(".tm-deactivate-license").removeClass("tm-hidden").addClass("tm-hidden"),s(".tm-activate-license").removeClass("tm-hidden")))}))}function o(t){var e=t.val(),a=s("#tm_epo_options_placement_custom_hook").closest("tr");"custom"===e?a.show():a.hide()}function n(t){var e=t.val(),a=s("#tm_epo_totals_box_placement_custom_hook").closest("tr");"custom"===e?a.show():a.hide()}function i(t){var e=t.val(),a=s("#tm_epo_options_placement").closest("tr"),i=s("#tm_epo_totals_box_placement").closest("tr"),l=s("#tm_epo_options_placement_custom_hook").closest("tr"),c=s("#tm_epo_totals_box_placement_custom_hook").closest("tr");"action"===e?(a.hide(),i.hide(),l.hide(),c.hide()):(a.show(),i.show(),o(s("#tm_epo_options_placement")),n(s("#tm_epo_totals_box_placement")))}function l(t){var e=t.val(),a=s("#tm_epo_floating_totals_box_visibility").closest("tr"),o=s("#tm_epo_floating_totals_box_add_button").closest("tr");"disable"===e?(a.hide(),o.hide()):(a.show(),o.show())}function c(t){var e=t.is(":checked"),a=s("#tm_epo_show_price_inside_option_hidden_even").closest("tr"),o=s("#tm_epo_multiply_price_inside_option").closest("tr");e?(a.show(),o.show()):(a.hide(),o.hide())}function r(t){var e=t.is(":checked"),a=s("#tm_epo_show_upload_image_replacement").closest("tr");e?a.hide():a.show()}function m(t){s(t).closest("td").css("position","relative").append('<label class="tm-epo-field-label"><span class="tm-epo-style-wrapper"><input type="checkbox" checked><span class="tm-epo-style"></span></span></label><label class="tm-epo-field-label"><span class="tm-epo-style-wrapper"><input type="radio" checked><span class="tm-epo-style"></span></span></label>')}function _(t){var e=t.val();s(".tm-epo-field-label").find(".tm-epo-style-wrapper, .tm-epo-style").removeClass("square square2 round round2").addClass(e)}function d(t){var e=t.val(),a=s("#tm_epo_css_styles_style").closest("tr");"on"===e?a.show():a.hide()}function p(t){s(t).closest("td").css("position","relative").append('<div class="tm-border-type"></div>')}function u(t){var e=t.val();s(".tm-border-type").removeClass("square round shadow thinline").addClass(e)}function f(t){return t.closest("tr")}function h(t,e,s,a){f(s).addClass("tm-hidden"),f(s.filter("."+t)).removeClass("tm-hidden"),a.find(".tm-section-desc .tm-section-menu-item").removeClass("active"),e.addClass("active")}var v=t.TMEPOADMINSETTINGSJS,b=t.wpCookies,g=t.confirm,y=t.toastr,w=0;s(e).ready(function(){var f,w=s(".tm-settings-wrap");w.length>0&&((f=w.find(":checkbox")).closest("label").addClass("tm-epo-switch-wrapper-label"),f.wrap('<span class="tm-epo-switch-wrapper tc"></span>'),f.after('<span class="tc-label tm-epo-switch tc"></span>'),s(".forminp .description").toArray().forEach(function(t,e){var a=s(t);a.closest("tr").find(".titledesc").append(a)}),s("#tm_epo_consent_for_transmit").closest("tr").after(s('<tr valign="top"><th scope="row" class="titledesc tm-license-div"></th><td class="forminp forminp-license"></td></tr>')),s(".tm-license-div").append(s(".tm-license-button")),s(".forminp-license").append(s(".tm-license-result")),s(t).on("tc-opentab.tmtabs tc-isopentab.tmtabs",function(t,e){var a,o,n,i=e.table.find(".tm-section-desc .tm-section-menu-item");i.length>0&&(a=b.get("tmadminextratab"),o=i.filter('[data-menu="'+a+'"]'),n=e.table.find("select,input,text,textarea"),a&&0!==o.length||(a=(o=s(i).eq(0)).attr("data-menu")),h(a,o,n,e.table))}),s(e).on("click",".tm-section-menu-item",function(){var t=s(this),e=t.attr("data-menu"),a=t.closest(".tm-tab");h(e,t,a.find("select,input,text,textarea"),a),b.set("tmadminextratab",e,10080,"")}),s(t).on("tc-tmtabs-clicked",function(t,e){var a,o,n,i,l,c=e.table.find(".tm-section-desc .tm-section-menu-item");c.length>0&&(a=b.get("tmadminextratab"),o=b.get("tmadminextratab-context"),n=e.header.attr(e.options.dataattribute),l=e.table.find("select,input,text,textarea"),a&&o===n?i=c.filter('[data-menu="'+a+'"]'):a=(i=s(c).eq(0)).attr("data-menu"),i.length>0&&!i.is(".active")&&(h(a,i,l,e.table),b.set("tmadminextratab-context",n)))}),s(e).on("click",".tc-save-button",function(t){var e=s(this).closest("form"),a=e.tcSerializeObject();a=s.extend(!0,a,{action:"tm_save_settings",save:"save",security:v.settings_nonce}),t.preventDefault(),e.block({message:null,overlayCSS:{background:"#fff url("+v.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}}),s.post(v.ajax_url,a,function(t){t&&(1===t.error?y.error(t.message,v.i18n_epo):y.success(t.message,v.i18n_epo))},"json").always(function(){e.unblock()})}),s(".tm-settings-wrap .tm-tabs").tmtabs(),s(".tm-activate-license").on("click",function(t){t.preventDefault(),a("activate")}),s(".tm-deactivate-license").on("click",function(t){t.preventDefault(),a("deactivate")}),s("#tm_epo_display").on("change",function(){i(s(this))}),s("#tm_epo_options_placement").on("change",function(){o(s(this))}),s("#tm_epo_totals_box_placement").on("change",function(){n(s(this))}),s("#tm_epo_css_styles").on("change",function(){d(s(this))}),s("#tm_epo_css_styles_style").on("change",function(){_(s(this))}),s("#tm_epo_css_selected_border").on("change",function(){u(s(this))}),s("#tm_epo_floating_totals_box").on("change",function(){l(s(this))}),s("#tm_epo_show_price_inside_option").on("change",function(){c(s(this))}),s("#tm_epo_show_hide_uploaded_file_url_cart").on("change",function(){r(s(this))}),i(s("#tm_epo_display")),o(s("#tm_epo_options_placement")),n(s("#tm_epo_totals_box_placement")),m(s("#tm_epo_css_styles_style")),_(s("#tm_epo_css_styles_style")),d(s("#tm_epo_css_styles")),p(s("#tm_epo_css_selected_border")),u(s("#tm_epo_css_selected_border")),l(s("#tm_epo_floating_totals_box")),c(s("#tm_epo_show_price_inside_option")),r(s("#tm_epo_show_hide_uploaded_file_url_cart")),s(e).on("click.cpf",".tm-mn-movetodir,.tm-mn-deldir,.tm-mn-delfile",function(t){var e,a=s(this),o=s(".forminp-tm_html");if(t.preventDefault(),o.length>0){if(o.data("doing_ajax"))return;if(a.is(".tm-mn-deldir")&&!g(v.i18n_mn_delete_folder))return;if(a.is(".tm-mn-delfile")&&!g(v.i18n_mn_delete_file))return;a.prepend('<i class="tm-icon tcfa tcfa-refresh tcfa-spin"></i>'),o.data("doing_ajax",1).block({message:null,overlayCSS:{background:"#fff url("+v.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}}),e={action:"tm_mn_movetodir",dir:a.attr("data-tm-dir"),security:v.settings_nonce},a.is(".tm-mn-deldir")?(e.action="tm_mn_deldir",e.tmdir=a.attr("data-tm-deldir")):a.is(".tm-mn-delfile")&&(e.action="tm_mn_delfile",e.tmfile=a.attr("data-tm-delfile"),e.tmdir=a.attr("data-tm-deldir")),s.post(v.ajax_url,e,function(t){var e;t&&t.result&&""!==t.result?o.html(t.result):t&&t.error&&t.message&&(e=s.tmEPOAdmin.builder_floatbox_template_import({id:"temp_for_floatbox_insert",html:'<div class="tm-inner">'+t.message+"</div>",title:v.i18n_error_title}),s.tcFloatBox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!0,refresh:"fixed",width:"50%",height:"300px",classname:"flasho tm_wrapper tm-error",data:e}))},"json").always(function(){o.data("doing_ajax",0).unblock(),a.find(".tm-icon").remove()})}})),s.tcToolTip()})}(window,document,window.jQuery);