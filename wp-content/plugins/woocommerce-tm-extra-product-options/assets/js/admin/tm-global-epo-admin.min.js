!function(e,t,i){"use strict";var n,a,l,o,r,d=e.wp,s=e.TMEPOADMINJS,m=e.TMEPOGLOBALADMINJS,c=e.confirm,_=e.toastr,p=e._,u=e.plupload,f=!1,b={tc_builder_elements:d.template("tc-builder-elements"),tc_builder_section:d.template("tc-builder-section")},v=e.JSON;b=i.epoAPI.applyFilter("tc_adjust_admin_template_engine",b),i.tm_array_values||(i.tm_array_values=function(e){var t=[];return Object.keys(e).forEach(function(i){e.hasOwnProperty(i)&&(t[t.length]=e[i])}),t}),i.tm_uniqid||(i.tm_uniqid=function(e,t){var i,n=function(e,t){return e=parseInt(e,10).toString(16),t<e.length?e.slice(e.length-t):t>e.length?Array(t-e.length+1).join("0")+e:e};return void 0===e&&(e=""),this.php_js||(this.php_js={}),this.php_js.uniqidSeed||(this.php_js.uniqidSeed=Math.floor(123456789*Math.random())),this.php_js.uniqidSeed+=1,i=e,i+=n(parseInt((new Date).getTime()/1e3,10),8),i+=n(this.php_js.uniqidSeed,5),t&&(i+=(10*Math.random()).toFixed(8).toString()),i}),i.tmEPOAdmin={add_events_done:0,add_sortables:function(){i.tmEPOAdmin.is_original&&(i(".builder_layout").sortable({handle:".move",cursor:"move",items:".builder_wrapper:not(.tma-nomove)",start:function(e,t){t.placeholder.height(t.helper.outerHeight()),t.placeholder.width(t.helper.outerWidth())},stop:function(){i.tmEPOAdmin.builder_reorder_multiple()},cancel:".tma-nomove",forcePlaceholderSize:!0,placeholder:"bitem pl2",forceHelperSize:!0,helper:"clone",tolerance:"pointer"}),i.tmEPOAdmin.builder_items_sortable(i(".builder_wrapper .bitem_wrapper")),i(".builder_elements .ditem").draggable({zIndex:5e3,scroll:!0,helper:"clone",start:function(e){i(e.target).css({opacity:.3}),i(".builder_layout .bitem_wrapper").not(".tma-variations-wrap .bitem_wrapper").addClass("highlight")},stop:function(e){i(".builder_layout .bitem_wrapper").removeClass("highlight"),i(e.target).css({opacity:1})},connectToSortable:".builder_layout .bitem_wrapper:not(.tma-nomove .bitem_wrapper)"}))},add_events:function(){var a,l,o,r;1!==i.tmEPOAdmin.add_events_done&&(i.tmEPOAdmin.add_sortables(),a=i("#builder_import_file"),(l=new u.Uploader({url:m.import_url,browse_button:a[0],file_data_name:"builder_import_file",multi_selection:!1})).init(),l.bind("FilesAdded",function(e){var t,n=i.tmEPOAdmin.builder_floatbox_template_import({id:"temp_for_floatbox_insert",html:"",title:m.i18n_import_title});o=i.tcFloatBox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!0,refresh:"fixed",width:"50%",height:"300px",classname:"flasho tm_wrapper",data:n}),t=i('<div class="tm_progress_bar tm_orange"><span class="tm_percent"></span></div><div class="tm_progress_info"><span class="tm_info"></span></div>'),i('<div class="override-selection"><button type="button" class="tc tc-button details_override">'+m.i18n_overwrite_existing_elements+'</button><button type="button" class="tc tc-button details_append">'+m.i18n_append_new_elements+"</button></div>").appendTo("#temp_for_floatbox_insert"),r=i.tmEPOAdmin.tm_escape(v.stringify(i.tmEPOAdmin.prepare_for_json(i("#tmformfieldsbuilderwrap").tcSerializeObject()))),m.is_original_post?(i(".details_override").on("click",function(){i("#temp_for_floatbox_insert").find(".override-selection").remove(),t.appendTo("#temp_for_floatbox_insert"),i(".tm_info").html(m.i18n_importing),e.setOption("multipart_params",{action:"import",import_override:1,post_id:m.post_id,tm_uploadmeta:r,security:m.import_nonce,is_original_post:m.is_original_post}),e.start(),i(".flasho").addClass("tm_color_orange")}),i(".details_append").on("click",function(){i("#temp_for_floatbox_insert").find(".override-selection").remove(),t.appendTo("#temp_for_floatbox_insert"),i(".tm_info").html(m.i18n_importing),e.setOption("multipart_params",{action:"import",import_override:0,post_id:m.post_id,tm_uploadmeta:r,security:m.import_nonce,is_original_post:m.is_original_post}),e.start(),i(".flasho").addClass("tm_color_orange")})):(i("#temp_for_floatbox_insert").find(".override-selection").remove(),t.appendTo("#temp_for_floatbox_insert"),i(".tm_info").html(m.i18n_importing),e.setOption("multipart_params",{action:"import",import_override:1,post_id:m.post_id,tm_uploadmeta:r,security:m.import_nonce,is_original_post:m.is_original_post}),e.start(),i(".flasho").addClass("tm_color_orange"))}),l.bind("FileUploaded",function(t,n,a){var l=i.epoAPI.util.parseJSON(a.response);l&&"result"in l&&l.message&&i(".tm_info").html(l.message),l&&l.error&&l.message&&i(".tm_info").html(l.message),l&&"result"in l&&1===i.epoAPI.math.toFloat(l.result)?(i(".tm_progress_bar").removeClass("tm_orange").addClass("tm_turquoise"),i(".tm_info").removeClass("tm_color_pomegranate").addClass("tm_color_turquoise"),i(".flasho").removeClass("tm_color_orange tm_color_pomegranate").addClass("tm_color_turquoise"),i(".floatbox-cancel").remove(),i(".tm_info").html(m.i18n_saving),i(e).off("beforeunload.edit-post"),l.options&&(i(".builder_layout").html(l.options),i.tmEPOAdmin.setGlobalVariationObject("initialitize_on_after"),_.success(l.message,m.i18n_epo)),o.destroy()):(i(".tm_progress_bar").removeClass("tm_orange").addClass("tm_pomegranate"),i(".tm_info").removeClass("tm_color_turquoise").addClass("tm_color_pomegranate"),i(".flasho").removeClass("tm_color_orange tm_color_turquoise").addClass("tm_color_pomegranate"))}),l.bind("UploadProgress",function(e,t){var n=parseInt(t.percent,10);i(".tm_progress_bar").css("width",n+"%"),i(".tm_percent").html(n+"%")}),l.bind("Error",function(e,t){t&&t.message&&i(".tm_info").removeClass("tm_color_turquoise").addClass("tm_color_pomegranate").html("\nError #"+t.code+": "+t.message),i(".tm_progress_bar").removeClass("tm_orange").addClass("tm_pomegranate"),i(".flasho").removeClass("tm_color_orange tm_color_turquoise").addClass("tm_color_pomegranate")}),l.bind("UploadComplete",function(){i("body").removeClass("overflow")}),i(t).on("click.cpf","#builder_export",function(t){var n,a,l=i(this),o=i("#tmformfieldsbuilderwrap");t.preventDefault(),l.data("doing_export")||(l.data("doing_export",1).prepend('<i class="tm-icon tcfa tcfa-refresh tcfa-spin"></i>'),n=i.tmEPOAdmin.prepare_for_json(o.tcSerializeObject()),a={action:"tm_export",metaserialized:n=v.stringify(n),is_original_post:m.is_original_post,security:m.export_nonce},i.post(m.ajax_url,a,function(t){var n;t&&t.result&&""!==t.result?e.location=t.result:t&&t.error&&t.message&&(n=i.tmEPOAdmin.builder_floatbox_template_import({id:"temp_for_floatbox_insert",html:'<div class="tm-inner">'+t.message+"</div>",title:m.i18n_error_title}),i.tcFloatBox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!0,refresh:"fixed",width:"50%",height:"300px",classname:"flasho tm_wrapper tm-error",data:n}))},"json").always(function(){l.data("doing_export",0).find(".tm-icon").remove()}))}),i(t).on("click.cpf","#builder_save",function(e){var t,n=i(this);n.data("doing_export")||(n.data("doing_export",1).prepend('<i class="tm-icon tcfa tcfa-refresh tcfa-spin"></i>'),t={action:"tm_save",tm_uploadmeta:i.tmEPOAdmin.tm_escape(v.stringify(i.tmEPOAdmin.prepare_for_json(i("#tmformfieldsbuilderwrap").tcSerializeObject()))),post_id:m.post_id,security:m.save_nonce},i("#tmformfieldsbuilderwrap").addClass("disabled"),e.preventDefault(),i.post(m.ajax_url,t,function(e){e&&e.result&&1===e.result?_.success(e.message,m.i18n_epo):_.error(e.message,m.i18n_epo)},"json").always(function(e){i("#tmformfieldsbuilderwrap").removeClass("disabled"),"-1"===e.responseText&&_.error(m.i18n_invalid_request,m.i18n_epo),n.data("doing_export",0).find(".tm-icon").remove()}))}),i(t).on("click.cpf","#builder_import,.tc-add-import-csv",function(e){e.preventDefault(),i("#builder_import_file").trigger("click")}),i(t).on("click.cpf","#builder_fullsize",function(e){e.preventDefault(),i("body").addClass("overflow fullsize")}),i(t).on("click.cpf","#builder_fullsize_close",function(e){e.preventDefault(),i("body").removeClass("overflow fullsize")}),i(t).on("click.cpf",".builder-add-element",i.tmEPOAdmin.builder_add_element_onClick),i(t).on("click.cpf",".builder_add_section,.tc-add-section ",i.tmEPOAdmin.builder_add_section_onClick),i(t).on("click.cpf",".builder-add-section-and-element,.tc-add-element",i.tmEPOAdmin.builder_add_section_and_element_onClick),i(t).on("click.cpf",".builder_add_variation",i.tmEPOAdmin.builder_add_variation_onClick),i(t).on("click.cpf",".builder_wrapper .btitle .edit",i.tmEPOAdmin.builder_section_item_onClick),i(t).on("click.cpf",".builder_wrapper .btitle .clone",i.tmEPOAdmin.builder_section_clone_onClick),i(t).on("click.cpf",".builder_wrapper .btitle .plus",i.tmEPOAdmin.builder_section_plus_onClick),i(t).on("click.cpf",".builder_wrapper .btitle .minus",i.tmEPOAdmin.builder_section_minus_onClick),i(t).on("click.cpf",".builder_wrapper .btitle .delete:not(.builder_wrapper.tma-variations-wrap .btitle .delete)",i.tmEPOAdmin.builder_section_delete_onClick),i(t).on("click.cpf",".builder_wrapper .btitle .fold",i.tmEPOAdmin.builder_section_fold_onClick),i(t).on("click",".builder_wrapper.tma-variations-wrap .btitle .delete",i.tmEPOAdmin.builder_variation_delete_onClick),i(t).on("click.cpf",".bitem .edit",i.tmEPOAdmin.builder_item_onClick),i(t).on("click.cpf",".bitem .clone",i.tmEPOAdmin.builder_clone_onClick),i(t).on("click.cpf",".bitem .plus",i.tmEPOAdmin.builder_plus_onClick),i(t).on("click.cpf",".bitem .minus",i.tmEPOAdmin.builder_minus_onClick),i(t).on("click",".bitem .delete",i.tmEPOAdmin.builder_delete_onClick),i(t).on("click.cpf",".builder-panel-add",i.tmEPOAdmin.builder_panel_add_onClick),i(t).on("click.cpf",".builder-panel-mass-add",i.tmEPOAdmin.builder_panel_mass_add_onClick),i(t).on("click.cpf",".builder-panel-populate",i.tmEPOAdmin.builder_panel_populate_onClick),i(t).on("click.cpf",".builder-image-delete",i.tmEPOAdmin.builder_image_delete_onClick),i(t).on("click.cpf",".builder_panel_delete",i.tmEPOAdmin.builder_panel_delete_onClick),i(".builder_panel_delete").on("click.cpf",i.tmEPOAdmin.builder_panel_delete_onClick),i(t).on("click.cpf",".builder_panel_delete_all",i.tmEPOAdmin.builder_panel_delete_all_onClick),i(t).on("click.cpf",".builder_panel_up",function(){var e=i(this),t=e.closest(".options_wrap");t.prev().before(t),i.tmEPOAdmin.panels_reorder(e.closest(".panels_wrap")),i.tmEPOAdmin.paginattion_init("current")}),i(t).on("click.cpf",".builder_panel_down",function(){var e=i(this),t=e.closest(".options_wrap");t.next().after(t),i.tmEPOAdmin.panels_reorder(e.closest(".panels_wrap")),i.tmEPOAdmin.paginattion_init("current")}),i(t).on("keyup.cpf change.cpf",".tm_option_title",function(){i(this).closest(".options_wrap").find(".tm_option_value").val(i(this).val())}),i(t).on("click.cpf",".tm_upload_button",i.tmEPOAdmin.upload),i(t).on("change.cpf",".use_images,.tm-use-lightbox,.use_colors",i.tmEPOAdmin.tm_upload),i(t).on("change.cpf",".use_url",i.tmEPOAdmin.tm_url),i(t).on("change.cpf",".tm-qty-selector",i.tmEPOAdmin.tm_qty_selector),i(t).on("change.cpf",".tm-pricetype-selector",i.tmEPOAdmin.tm_pricetype_selector),i(t).on("change.cpf",".variations-display-as",i.tmEPOAdmin.variations_display_as),i(t).on("change.cpf",".tm-attribute .tm-changes-product-image",i.tmEPOAdmin.variations_display_as),i(t).on("click.cpf",".tm-upload-button-remove",i.tmEPOAdmin.tm_upload_button_remove_onClick),i(t).on("change.cpf",".tm-weekday-picker",i.tmEPOAdmin.tm_weekday_picker),i(t).on("click.cpf",".tm-tags-container .tab-header",function(){var e=i(this),t=e.closest(".tm-tags-container"),n=t.find(".tm-elements-container").find("li.tm-element-button"),a=t.find(".tab-header"),l=e.attr("data-tm-tag");a.removeClass("open").addClass("closed"),e.removeClass("closed").addClass("open"),"all"===l?n.removeClass("tm-hidden"):(n.addClass("tm-hidden"),n.filter("."+l).removeClass("tm-hidden"))}),i(t).on("click.cpf",".tm_editor_wrap",function(){var t=i(this).find("textarea");t.attr("id")&&(e.wpActiveEditor=t.attr("id"))}),i(t).on("change.cpf",".cpf-logic-element",i.tmEPOAdmin.cpf_logic_element_onchange),i(t).on("change.cpf",".cpf-logic-operator",i.tmEPOAdmin.cpf_logic_operator_onchange),i(t).on("change.cpf",".activate-sections-logic, .activate-element-logic",function(){1===parseInt(i(this).val(),10)?i(this).parent().find(".builder-logic-div").show():i(this).parent().find(".builder-logic-div").hide()}),i(t).on("dblclick.cpf",".tm-default-radio",function(){i(this).removeAttr("checked").prop("checked",!1)}),i(t).on("click",".tm-element-label,.tm-internal-label",function(){var e=i(this);i.tmEPOAdmin.current_edit_label=e,e.addClass("tm-hidden").closest(".tm-label-desc").addClass("tm-hidden").next(".tm-label-desc-edit").removeClass("tm-hidden").find(".tm-internal-name").focus()}),i(t).mouseup(function(e){var t,n=i.tmEPOAdmin.current_edit_label;i.tmEPOAdmin.current_edit_label&&(n.is(e.target)||0!==n.has(e.target).length||i(e.target).is(".tm-internal-name")||((t=n.closest(".tm-label-desc").next(".tm-label-desc-edit").find(".tm-internal-name")).trigger("change"),n.is(".tm-internal-label")&&n.html(t.val()).removeClass("tm-hidden"),n.is(".tm-element-label")&&n.removeClass("tm-hidden").closest(".tm-label-desc").find(".tm-internal-label").html(t.val()),n.closest(".tm-label-desc").removeClass("tm-hidden").next(".tm-label-desc-edit").addClass("tm-hidden"),""===t.val()?(n.closest(".tm-label-desc").removeClass("tc-has-value").addClass("tc-empty-value"),n.closest(".tm-label-desc").find(".tm-internal-label").html(n.closest(".tm-label-desc").find(".tm-element-label").html()),t.val(n.closest(".tm-label-desc").find(".tm-element-label").html())):n.closest(".tm-label-desc").removeClass("tc-empty-value").addClass("tc-has-value"),i.tmEPOAdmin.current_edit_label=!1))}),i(t).on("change.cpf",".multiple_radiobuttons_options",function(){var e=i(this),t=e.closest(".panels_wrap");"fee"===e.val()?t.find(".multiple_radiobuttons_options").val("fee"):"subscriptionfee"===e.val()?t.find(".multiple_radiobuttons_options").val("subscriptionfee"):t.find(".multiple_radiobuttons_options").filter(function(){return"fee"===this.value||"subscriptionfee"===this.value}).val(e.val())}),i(t).on("change.cpf",".tm_select_price_type",function(){var e=i(this),t=e.closest(".builder_element_wrap").find(".panels_wrap");"fee"===e.val()?(t.find(".multiple_selectbox_options").children('option[value="percentcurrenttotal"]').hide(),t.find(".multiple_selectbox_options").filter(function(){return"percentcurrenttotal"===this.value}).val("")):t.find(".multiple_selectbox_options").children('option[value="percentcurrenttotal"]').show(),i.tmEPOAdmin.selectbox_price_type(e)}),i(t).on("click.cpf",".cpf-add-rule",i.tmEPOAdmin.cpf_add_rule),i(t).on("click.cpf",".cpf-delete-rule",i.tmEPOAdmin.cpf_delete_rule),i(t).on("click.cpf",".tma-handle-wrap .tma-handle",i.tmEPOAdmin.builder_fold_onClick),i(t).on("keyup change","#temp_for_floatbox_insert .n[type=text]",function(){var e,t=i(this),a=t.val(),l=new RegExp("[^-0-9%.\\"+n.mon_decimal_point+"]+","gi"),o=a.replace(l,"");return a!==o&&(t.val(o),0===t.parent().find(".wc_error_tip").length&&(e=t.position(),t.after('<div class="wc_error_tip">'+n.i18n_mon_decimal_error+"</div>"),i(".wc_error_tip").css("left",e.left+t.width()-t.width()/2-i(".wc_error_tip").width()/2).css("top",e.top+t.height()).fadeIn("100"))),this}),i(t).on("click",".builder_elements .tc-handle",function(){var e=i(this),t=e.closest(".builder_elements");e.data("folded")||void 0===e.data("folded")?(e.data("folded",!1),e.removeClass("tcfa-caret-up").addClass("tcfa-caret-down"),t.removeClass("closed")):(e.data("folded",!0),e.removeClass("tcfa-caret-down").addClass("tcfa-caret-up"),t.addClass("closed")),i.tmEPOAdmin.fix_content_float()}),i(t).on("click",".tc-enable-responsive",function(){var e=i(this),t=e.find(".on"),n=e.find(".off"),a=i("#temp_for_floatbox_insert").find(".builder_responsive_div");e.is(".active")?(e.removeClass("active"),t.addClass("tm-hidden"),n.removeClass("tm-hidden"),a.hide()):(e.addClass("active"),t.removeClass("tm-hidden"),n.addClass("tm-hidden"),a.show())}),i(t).on("change.cpf",".tma-variations-section .sections_style",function(){var e=i("#temp_for_floatbox_insert");e.find(".builder_hide_for_variations").hide(),e.find(".builder_hide_for_variation").hide()}),i().ajaxChosen&&i("select.ajax_chosen_select_tm_product_ids").ajaxChosen({method:"GET",url:m.ajax_url,dataType:"json",afterTypeDelay:100,data:{action:"woocommerce_json_search_products",security:m.search_products_nonce}},function(e){var t={};return i.each(e,function(e,i){t[e]=i}),t}),i("body").on("woocommerce-product-type-change",function(){var e,t=i("#product-type");i.tmEPOAdmin.init_sections_check(),i.tmEPOAdmin.fix_content_float(),t.length&&("variable"!==t.val()&&"variable-subscription"!==t.val()&&(e=i(".builder_layout .element-variations")).length&&(e.closest(".builder_wrapper").remove(),i.tmEPOAdmin.builder_reorder_multiple(),i(".builder_layout .builder_wrapper").each(function(e,t){i.tmEPOAdmin.logic_init(i(t))}),i.tmEPOAdmin.init_sections_check(),i.tmEPOAdmin.fix_content_float(),i.tmEPOAdmin.toggle_variation_button(),i.tmEPOAdmin.var_remove("tm-style-variation-added")),i.tmEPOAdmin.toggle_variation_button())}),i(t).on("change.cpf",".builder_textfield_price_type",function(){i.tmEPOAdmin.set_fields_change(i(this))}),i(t).on("changetitle.cpf",".tm-header-title",function(){i.tmEPOAdmin.set_field_title(i(this))}),i(t).on("sections_type_onChange.cpf",".builder_wrapper",function(){i.tmEPOAdmin.sections_type_onChange(i(this))}),i(t).on("click.cpf",".meta-disable-categories",function(){i.tmEPOAdmin.disable_categories()}),i(t).on("change.cpf",".product_page_tm-global-epo #product_catdiv input:checkbox, .product_page_tm-global-epo #tm_product_ids, .product_page_tm-global-epo #tm_enabled_options, .product_page_tm-global-epo #tm_disabled_options",function(){i.tmEPOAdmin.check_if_applied()}),i.tmEPOAdmin.add_events_done=1)},initialitize:function(){i.tmEPOAdmin.setGlobalVariationObject("initialitize_on")},initialitize_on:function(){i.tmEPOAdmin.isinit=!0,i.tmEPOAdmin.pre_element_logic_init_obj={},i.tmEPOAdmin.pre_element_logic_init_obj_options={},i.tmEPOAdmin.pre_element_logic_init(!0),i.tmEPOAdmin.pre_element_logic_init_done=!0,i.tmEPOAdmin.is_original=0===i(".tm-wmpl-disabled").length,i.tmEPOAdmin.current_edit_label=!1,i.tmEPOAdmin.toggle_variation_button(),i.tmEPOAdmin.add_events(),i.tmEPOAdmin.check_section_logic(),i.tmEPOAdmin.check_element_logic(),i.tmEPOAdmin.section_logic_start(),i.tmEPOAdmin.element_logic_start(),i.tmEPOAdmin.set_hidden(),i.tmEPOAdmin.set_fields_change(),i.tmEPOAdmin.set_field_title(),i(".builder_wrapper.tm-slider-wizard").each(function(){var e=i(this);i.tmEPOAdmin.create_slider(e)}),i("#taxonomy-product_cat").before(i("#tc_disabled_categories").removeClass("hidden")),i.tmEPOAdmin.disable_categories(),i("#product_catdiv").before(i('<div class="tc-info-box hidden"></div>')),i.tmEPOAdmin.check_if_applied(),i.tmEPOAdmin.init_sections_check(),i.tmEPOAdmin.fix_content_float(),i.tmEPOAdmin.fix_form_submit(),i.tmEPOAdmin.pre_element_logic_init_done=!1,i.tmEPOAdmin.isinit=!1},initialitize_on_after:function(){i.tmEPOAdmin.isinit=!0,i.tmEPOAdmin.pre_element_logic_init_obj={},i.tmEPOAdmin.pre_element_logic_init_obj_options={},i.tmEPOAdmin.pre_element_logic_init(!0),i.tmEPOAdmin.pre_element_logic_init_done=!0,i.tmEPOAdmin.is_original=0===i(".tm-wmpl-disabled").length,i.tmEPOAdmin.current_edit_label=!1,i.tmEPOAdmin.var_remove("tm-style-variation-added"),i.tmEPOAdmin.toggle_variation_button(),i.tmEPOAdmin.add_sortables(),i.tmEPOAdmin.check_section_logic(),i.tmEPOAdmin.check_element_logic(),i.tmEPOAdmin.section_logic_start(),i.tmEPOAdmin.element_logic_start(),i.tmEPOAdmin.set_fields_change(),i.tmEPOAdmin.set_field_title(),i(".builder_wrapper.tm-slider-wizard").each(function(){var e=i(this);i.tmEPOAdmin.create_slider(e)}),i.tmEPOAdmin.init_sections_check(),i.tmEPOAdmin.fix_content_float(),i.tmEPOAdmin.fix_form_submit(),i.tmEPOAdmin.pre_element_logic_init_done=!1,i.tmEPOAdmin.isinit=!1},cpf_logic_element_onchange:function(e,t){var n,a,l,o,r,d,s,m,c=i(this);e instanceof i&&(c=e),void 0===t&&(t=!(t=i(this).closest(".section_elements, .builder_wrapper, .bitem, .builder_element_wrap")).is(".section_elements")&&!t.is(".builder_wrapper")),n=t?i.tmEPOAdmin.element_logic_object:i.tmEPOAdmin.logic_object,a=c.val(),l=c.children("option:selected").attr("data-section"),o=c.children("option:selected").attr("data-type"),r=l in(r=n)&&(a in(r=n[l].values)&&n[l].values[a]),d=c.closest(".tm-logic-rule").find(".tm-logic-value"),m=(s=c.closest(".tm-logic-rule").find(".cpf-logic-operator")).val(),r?(r=i(r),d.empty().append(r),s.find("[value='is']").show(),s.find("[value='isnot']").show(),"variation"===o||"multiple"===o?("startswith"!==m&&"endswith"!==m&&"greaterthan"!==m&&"lessthan"!==m||s.val("isempty"),s.find("[value='startswith']").hide(),s.find("[value='endswith']").hide(),s.find("[value='greaterthan']").hide(),s.find("[value='lessthan']").hide(),s.trigger("change.cpf")):(s.find("[value='startswith']").show(),s.find("[value='endswith']").show(),s.find("[value='greaterthan']").show(),s.find("[value='lessthan']").show())):a===l?("is"!==m&&"isnot"!==m&&"startswith"!==m&&"endswith"!==m&&"greaterthan"!==m&&"lessthan"!==m||s.val("isempty"),s.find("[value='is']").hide(),s.find("[value='isnot']").hide(),s.find("[value='startswith']").hide(),s.find("[value='endswith']").hide(),s.find("[value='greaterthan']").hide(),s.find("[value='lessthan']").hide(),s.trigger("change.cpf")):(s.find("[value='is']").show(),s.find("[value='isnot']").show(),s.find("[value='startswith']").show(),s.find("[value='endswith']").show(),s.find("[value='greaterthan']").show(),s.find("[value='lessthan']").show())},cpf_logic_operator_onchange:function(e){var t,n,a=i(this);e instanceof i&&(a=e),t=a.val(),n=a.closest(".tm-logic-rule").find(".tm-logic-value"),"isempty"===t||"isnotempty"===t?n.hide():n.show()},create_slider:function(e){e.tmtabs({headers:".tm-slider-wizard-headers",header:".tm-slider-wizard-header",selectedtab:0,showonhover:function(){return i.tmEPOAdmin.is_element_dragged},useclasstohide:!0,afteraddtab:function(t,n){i.tmEPOAdmin.builder_items_sortable(n),e.find(".tm_builder_section_slides").val(function(){return e.is(".tm-slider-wizard")?e.find(".bitem_wrapper").map(function(e,t){return i(t).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""})},deletebutton:!0,deleteconfirm:!0,afterdeletetab:function(){e.find(".tm_builder_section_slides").val(function(){return e.is(".tm-slider-wizard")?e.find(".bitem_wrapper").map(function(e,t){return i(t).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}),i.tmEPOAdmin.builder_reorder_multiple(),i(".builder_layout .builder_wrapper").each(function(e,t){i.tmEPOAdmin.logic_init(i(t))}),i.tmEPOAdmin.init_sections_check(),i.tmEPOAdmin.fix_content_float()}})},sections_type_onChange:function(e){var t,n,a=e.find(".bitem_wrapper"),l=e.find(".section_elements .sections_type").val();"slider"!==l||e.hasClass("tm-slider-wizard")?"slider"!==l&&e.hasClass("tm-slider-wizard")&&(e.find(".bitem_wrapper").wrapAll('<div class="tmtemp"></div>'),e.find(".bitem_wrapper .bitem").appendTo(e.find(".tmtemp")),e.find(".bitem_wrapper").remove(),e.find(".tmtemp").addClass("bitem_wrapper").removeClass("tmtemp"),i.tmEPOAdmin.builder_items_sortable(e.find(".bitem_wrapper")),e.find(".tm-slider-wizard-headers").remove(),e.removeClass("tm-slider-wizard"),e.find(".tm_builder_section_slides").val("")):(e.addClass("tm-slider-wizard"),t='<div class="tm-box"><h4 class="tm-slider-wizard-header" data-id="tm-slide0">1</h4></div>',n='<div class="tm-box tm-add-box"><h4 class="tm-add-tab"><span class="tcfa tcfa-plus"></span></h4></div>',a.before('<div class="transition tm-slider-wizard-headers">'+t+n+"</div>"),a.addClass("tm-slider-wizard-tab tm-slide0"),i.tmEPOAdmin.create_slider(e),e.find(".tm_builder_section_slides").val(function(){return e.is(".tm-slider-wizard")?e.find(".bitem_wrapper").map(function(e,t){return i(t).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}))},variation_events_success:function(){setTimeout(function(){i.tmEPOAdmin.setGlobalVariationObject("reindex")},600),i(t).unbind("ajaxSuccess",i.tmEPOAdmin.variation_events_success),i.tmEPOAdmin.var_remove("tma-remove_variation-added")},tm_variations_check_events_success:function(){setTimeout(function(){i.tmEPOAdmin.tm_variations_check_for_changes=1,i.tmEPOAdmin.tm_variations_check()},600),i(t).unbind("ajaxSuccess",i.tmEPOAdmin.tm_variations_check_events_success),i.tmEPOAdmin.var_remove("tma-remove_variation-added")},add_variation_events:function(){!0!==i.tmEPOAdmin.var_is("tma-variation-events-added")&&(!0!==i.tmEPOAdmin.var_is("tma-remove_variation-added")&&i("#variable_product_options").on("click.tma",".remove_variation",function(){i(t).ajaxSuccess(i.tmEPOAdmin.variation_events_success),i.tmEPOAdmin.var_is("tma-remove_variation-added",!0),i(t).ajaxSuccess(i.tmEPOAdmin.tm_variations_check_events_success)}),!0!==i.tmEPOAdmin.var_is("tma-remove_variation-added")&&i(".wc-metaboxes-wrapper").on("click","a.bulk_edit",function(){"delete_all"===i("select#field_to_edit").val()&&(i(t).ajaxSuccess(i.tmEPOAdmin.variation_events_success),i.tmEPOAdmin.var_is("tma-remove_variation-added",!0),i(t).ajaxSuccess(i.tmEPOAdmin.tm_variations_check_events_success))}),i("#variable_product_options").on("woocommerce_variations_added",function(){i.tmEPOAdmin.setGlobalVariationObject("reindex"),i(t).ajaxSuccess(i.tmEPOAdmin.tm_variations_check_events_success)}),i("#woocommerce-product-data").on("woocommerce_variations_saved",function(){i.tmEPOAdmin.setGlobalVariationObject("reindex"),i(t).ajaxSuccess(i.tmEPOAdmin.tm_variations_check_events_success)}),i(t).on("click.cpf",".save_attributes",function(){i(t).ajaxSuccess(i.tmEPOAdmin.tm_variations_check_events_success)}),i.tmEPOAdmin.var_is("tma-variation-events-added",!0))},toggle_variation_button:function(){var e,t,n,a=i("#product-type");a.length&&("variable"===a.val()||"variable-subscription"===a.val()?(i(".builder_add_section").addClass("inline"),i(".builder_add_variation").addClass("inline").removeClass("tm-hidden"),i(".tma-variations-wrap").removeClass("tm-hidden"),i.tmEPOAdmin.add_variation_events(),t=!1,(e=i(".builder_layout .element-variations")).length?"1"===e.find(".tm-variations-disabled").val()&&(t=!0,e=i(".builder_layout .element-variations"),i.tmEPOAdmin.var_is("tm-style-variation-forced",!0)):(i.tmEPOAdmin.var_is("tm-style-variation-forced",!0),i.tmEPOAdmin.builder_add_variation_onClick(),t=!0,e=i(".builder_layout .element-variations")),e.length&&((n=e.closest(".builder_wrapper")).find(".tm-add-element-action,.tmicon.clone,.tmicon.size,.tmicon.move,.tmicon.plus,.tmicon.minus").remove(),n.addClass("tma-nomove tma-variations-wrap"),n.find(".builder_hide_for_variation").hide(),n.find(".tma-tab-logic,.tma-tab-css,.tma-tab-woocommerce").hide(),i.tmEPOAdmin.var_is("tm-style-variation-added",!0),e.addClass("tma-nomove"),e.find(".tmicon.size,.tmicon.clone,.tmicon.move,.tmicon.plus,.tmicon.minus,.tmicon.delete").remove(),e.find(".tma-tab-logic,.tma-tab-css,.tma-tab-woocommerce").remove(),t?(e.find(".tm-variations-disabled").val("1"),i(".builder_add_section").addClass("inline"),i(".builder_add_variation").addClass("inline").removeClass("tm-hidden"),i(".tma-variations-wrap").addClass("tm-hidden")):(e.find(".tm-variations-disabled").val(""),i(".builder_add_section").removeClass("inline"),i(".builder_add_variation").removeClass("inline").addClass("tm-hidden"),i(".tma-variations-wrap").removeClass("tm-hidden")))):(i(".builder_add_section").removeClass("inline"),i(".builder_add_variation").removeClass("inline").addClass("tm-hidden")))},can_take_logic:function(){return".element-color,.element-range,.element-radiobuttons,.element-checkboxes,.element-selectbox,.element-textfield,.element-textarea,.element-variations"},prepare_for_json:function(e){var t,n,a,l={};return Object.keys(e).forEach(function(o){0===o.indexOf("tm_meta[")&&((t=o.split(/[\[\]]{1,2}/)).pop(),t=t.map(function(e){return""===e?null:e}),a=t.length>0&&null===t[t.length-1],t=t.filter(function(e){if(null!==e&&void 0!==e)return e}),n="object"!=typeof e[o]&&a?[e[o]]:e[o],l=i.tmEPOAdmin.constructObject(t,n,l))}),l},constructObject:function(e,t,n){var a=e.shift();return e.length>0?(n.hasOwnProperty(a)||(n[a]={}),n[a]=i.tmEPOAdmin.constructObject(e,t,n[a])):n[a]=t,n},create_tm_meta_serialized:function(){var e,t,n,a,l=i("input#wp-preview"),o=i("#tmformfieldsbuilderwrap"),r=i("#post"),d=i("#editor"),s=1===r.length?r:d;e=o.find('[name^="tm_meta["]'),i(".tm_meta_serialized").remove(),i(".tm_meta_serialized_wpml").remove(),e.attr("disabled",!1),n=i.tmEPOAdmin.is_original?"tm_meta_serialized":"tm_meta_serialized_wpml",t=i.tmEPOAdmin.prepare_for_json(s.tcSerializeObject()),t=i.tmEPOAdmin.tm_escape(v.stringify(t)),a=i("<textarea class='tm_meta_serialized tm-hidden' name='"+n+"'></textarea>").val(t),o.prepend(a),e.attr("disabled","disabled"),l.length>0&&""!==l.val()&&(e.not(".tm-wmpl-disabled").attr("disabled",!1),i(".tm_meta_serialized").remove())},fix_form_submit:function(){var e,t,n=i("#post");1===n.length?n.on("submit",function(){return i.tmEPOAdmin.create_tm_meta_serialized(i(this)),!0}):d.data&&"subscribe"in d.data&&(e=!1,"function"==typeof(t=d.data.subscribe)&&t(function(){var t=d.data.select("core/editor").isSavingPost(),n=d.data.select("core/editor").didPostSaveRequestSucceed(),a=d.data.select("core/editor").didPostSaveRequestFail();!e&&t&&(e=!0,i.tmEPOAdmin.create_tm_meta_serialized()),e&&(n||a)&&(e=!1,i("#tm_extra_product_options").find('[name^="tm_meta["]').attr("disabled",!1),setTimeout(function(){i(".tm_meta_serialized").remove(),i(".tm_meta_serialized_wpml").remove()},600))}))},init_sections_check:function(){var e=i(".builder_wrapper").length;1===e&&i(".builder_wrapper.tma-variations-wrap.tm-hidden").length&&(e=0),e?(i(".builder_elements").show(),i(".builder-add-section-action").show(),i(".builder_selector").show(),i(".tc-welcome").hide()):(i(".builder_elements").hide(),i(".builder-add-section-action").hide(),i(".builder_selector").hide(),i(".tc-welcome").show())},fix_content_float:function(){var e;e=i(".builder_elements").is(":hidden")?0:i(".builder_elements").outerHeight(),i("#wpcontent").css("margin-bottom",e+"px")},disable_categories:function(){i(".meta-disable-categories").is(":checked")?i("#taxonomy-product_cat").slideUp():i("#taxonomy-product_cat").slideDown()},check_if_applied:function(){var e,t,n,a,l;i("body").is(".product_page_tm-global-epo")&&(e=i("#tm_meta_disable_categories:checked").length>0,t=i("#product_catdiv input:checkbox").not(i("#tm_meta_disable_categories")).filter(":checked").length>0,n=i("#tm_product_ids").val(),a=i("#tm_enabled_options").val(),l=i("#tm_disabled_options").val(),n=!(!n||null===n)&&n.length>0,a=!(!a||null===a)&&a.length>0,l=!(!l||null===l)&&l.length>0,e?n||a||l?i(".tc-info-box").removeClass("tc-error tc-all-products").addClass("hidden").html(""):i(".tc-info-box").removeClass("hidden tc-all-products").addClass("tc-error").html(m.i18n_form_not_applied_to_all):t?i(".tc-info-box").removeClass("tc-error tc-all-products").addClass("hidden").html(""):i(".tc-info-box").removeClass("hidden error").addClass("tc-all-products").html(m.i18n_form_is_applied_to_all))},check_section_logic:function(e){!e&&i.tmEPOAdmin.isinit&&i.tmEPOAdmin.done_check_section_logic||(e||(e=i("#tmformfieldsbuilderwrap").find("div.builder_wrapper")),e.each(function(e,t){var n=i(t),a=n.find(".tm-builder-sections-uniqid").val();a&&""!==a&&void 0!==a&&!1!==a||n.find(".tm-builder-sections-uniqid").val(i.tm_uniqid("",!0)),1===parseInt(n.find(".activate-sections-logic").val(),10)?n.find(".builder-logic-div").show():n.find(".builder-logic-div").hide()}),i.tmEPOAdmin.done_check_section_logic=!0)},check_element_logic:function(e){var t=[],n=!1;!e&&i.tmEPOAdmin.isinit&&i.tmEPOAdmin.done_check_section_logic||(e||(e=i("#tmformfieldsbuilderwrap").find("div.bitem"),n=!0),e.each(function(e,a){var l;l=(a=i(a)).find(".tm-builder-element-uniqid").val(),(n&&-1!==t.indexOf(l)||!l||""===l||void 0===l||!1===l)&&a.find(".tm-builder-element-uniqid").val(i.tm_uniqid("",!0)),n&&t.push(a.find(".tm-builder-element-uniqid").val()),1===parseInt(a.find(".activate-element-logic").val(),10)?a.find(".builder-logic-div").show():a.find(".builder-logic-div").hide()}),i.tmEPOAdmin.done_check_section_logic=!0)},section_logic_start:function(e){e||(e=i(".builder_layout .builder_wrapper")),e.each(function(e,t){var n;t=i(t),i.tmEPOAdmin.logic_init(t);try{n=t.find(".section_elements .tm-builder-clogic").val()||"null",n=i.epoAPI.util.parseJSON(n),n=i.tmEPOAdmin.logic_check_section_rules(n),t.find(".section_elements .tm-builder-clogic").val(v.stringify(n)),t.find(".section_elements .epo-rule-toggle").val(n.toggle),t.find(".section_elements .epo-rule-what").val(n.what)}catch(e){return}})},element_logic_start:function(e){var t;e||(e=i(".builder_layout .builder_wrapper .bitem")),e.each(function(e,n){n=i(n),i.tmEPOAdmin.element_logic_init(n);try{t=n.find(".tm-builder-clogic").val()||"null",t=i.epoAPI.util.parseJSON(t),t=i.tmEPOAdmin.logic_check_element_rules(t),n.find(".tm-builder-clogic").val(v.stringify(t)),n.find(".epo-rule-toggle").val(t.toggle),n.find(".epo-rule-what").val(t.what)}catch(e){return}})},panels_reorder:function(e){i(e).children(".options_wrap").each(function(e,t){i(t).find(".tm-default-radio,.tm-default-checkbox").val(e)})},panels_sortable:function(e){0!==i(e).length&&i.tmEPOAdmin.is_original&&e.not(i(".builder_elements .panels_wrap")).sortable({handle:".tm_cell_move",cancel:"input,select,button",cursor:"move",tolerance:"pointer",forcePlaceholderSize:!0,placeholder:"panel_wrap pl",stop:function(e,t){i.tmEPOAdmin.panels_reorder(i(t.item).closest(".panels_wrap"))}})},builder_panel_delete_all_onClick:function(e){var t,n=i(this).closest(".onerow").find(".tcpagination"),a=i(".flasho.tm_wrapper").find(".panels_wrap");e.preventDefault(),i(this).trigger("hideTtooltip"),n.tcPagination("destroy"),a.children().length>1&&((t=a.find(".options_wrap")).each(function(e){if(0===e)return!0;i(this).remove(),a.find(".numorder").each(function(e){i(this).html(parseInt(e,10)+1)})}),t.find("input").val(""),i.tmEPOAdmin.panels_reorder(a))},builder_image_delete_onClick:function(e){e.preventDefault(),i(this).trigger("hideTtooltip"),i(this).closest(".tm_cell_images").find("input."+i(this).attr("rel")).val(""),i(this).closest("span").find("img").attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=")},builder_panel_delete_onClick:function(e){var t=i(this).closest(".panels_wrap");e.preventDefault(),i(this).trigger("hideTtooltip"),t.children().length>1&&i(this).closest(".options_wrap").css({margin:"0 auto"}).animate({opacity:0,height:0,width:0},300,function(){i(this).remove(),t.find(".numorder").each(function(e){i(this).html(parseInt(e,10)+1)}),t.children(".options_wrap").each(function(e){i(this).find("[id]").each(function(){var t=i(this).attr("name").replace(/[\[\]]/g,"");i(this).attr("id",t+"_"+e)})}),i.tmEPOAdmin.panels_reorder(t)})},builder_panel_mass_add_onClick:function(e){var t,n=i(this);e.preventDefault(),n.is(".disabled")||(n.addClass("disabled"),t='<div class="tm-panel-populate-wrapper"><textarea class="tm-panel-populate"></textarea><button type="button" class="tc tc-button builder-panel-populate">'+m.i18n_populate+"</button></div>",n.after(t))},builder_panel_populate_onClick:function(e){var t=i(".flasho.tm_wrapper").find(".panels_wrap"),n=t.children(),a=i(""),l=i(".tm-panel-populate").val().split(/\n/),o=[];e.preventDefault(),i(this).remove(),l.forEach(function(e){/\S/.test(e)&&o.push(i.trim(e))}),o.forEach(function(e){var l,o=e.split("|"),r=o.length;0!==r&&(1===r&&(o[1]=0),o[0]=i.trim(o[0]),o[1]=parseFloat(i.trim(o[1])),Number.isFinite(o[1])||(o[1]=""),l=i.tmEPOAdmin.add_panel_row(o,t,n),a=a.add(l))}),a.length&&(t.append(a),i.tcToolTip(a.find(".tm-tooltip"))),i(".builder-panel-mass-add").removeClass("disabled"),i(".tm-panel-populate-wrapper").remove(),i.tmEPOAdmin.paginattion_init("last")},add_panel_row:function(e,t,n){var a=n.last().tcClone();return a?(i.tmEPOAdmin.builder_clone_after_events(a),i.tmEPOAdmin.gen_events(a),a.find("[name]").val(""),a.find("[id]").each(function(){var e=i(this).attr("name").replace(/[\[\]]/g,""),t=n.length;i(this).attr("id",e+"_"+t)}),a.find(".tm_option_title").val(e[0]),a.find(".tm_option_value").val(e[0]),a.find(".tm_option_price").val(e[1]),e[2]&&(a.find(".tm_option_price_type").val(e[2]),!1===a.find(".tm_option_price_type").val()&&a.find(".tm_option_price_type").val("")),e[3]&&(a.find(".tm_option_description").val(e[3]),!1===a.find(".tm_option_description").val()&&a.find(".tm_option_description").val("")),a.find(".numorder").html(parseInt(parseInt(n.length,10)+1,10)),a.find(".tm_upload_image img").attr("src",""),a.find("input.tm_option_image").val(""),a.find(".tm-default-radio,.tm-default-checkbox").removeAttr("checked").prop("checked",!1).val(n.length),a):i("")},builder_panel_add_onClick:function(e){var t,n=i(this).prev(".panels_wrap"),a=n.children(),l=a.last().tcClone();e.preventDefault(),l&&(t=n.find(".multiple_radiobuttons_options").first().val(),i.tmEPOAdmin.builder_clone_after_events(l),i.tmEPOAdmin.gen_events(l),l.find("[name]").val(""),l.find("[id]").each(function(){var e=i(this).attr("name").replace(/[\[\]]/g,""),t=a.length;i(this).attr("id",e+"_"+t)}),l.find(".numorder").html(parseInt(parseInt(a.length,10)+1,10)),l.find(".tm_upload_image img").attr("src",""),l.find("input.tm_option_image").val(""),l.find(".tm-default-radio,.tm-default-checkbox").removeAttr("checked").prop("checked",!1).val(a.length),"fee"===t?l.find(".tm_option_price_type").val("fee"):"subscriptionfee"===t&&l.find(".tm_option_price_type").val("subscriptionfee"),n.append(l),i.tcToolTip(l.find(".tm-tooltip")),i.tmEPOAdmin.paginattion_init("last"),i.tmEPOAdmin.tm_upload())},builder_add_section_onClick:function(t,n){var a,l=i.epoAPI.template.html(b.tc_builder_section,{});return t&&t.preventDefault(),!(!l||!(a=i(l)))&&(a.addClass("w100"),a.addClass("appear"),a.find(".tm-builder-sections-uniqid").val(i.tm_uniqid("",!0)),n?a.appendTo(".builder_layout"):i(".builder_layout .tma-variations-wrap").length>0?i(".builder_layout .tma-variations-wrap").after(a):a.prependTo(".builder_layout"),i.tmEPOAdmin.gen_events(a),a.find(".tm-tabs").tmtabs(),i.tmEPOAdmin.check_section_logic(a),i.tmEPOAdmin.logic_init(a),i.tmEPOAdmin.builder_items_sortable(a.find(".bitem_wrapper")),i.tmEPOAdmin.builder_reorder_multiple(),i(this).is("a")&&i(e).tcScrollTo(a),i.tmEPOAdmin.init_sections_check(),i.tmEPOAdmin.fix_content_float(),a)},builder_add_element_onClick:function(e){var t=i(this),n=i.tmEPOAdmin.builder_floatbox_template_import({id:"temp_for_floatbox_insert",html:'<div class="tm-inner">'+m.element_data+"</div>",title:m.i18n_add_element}),a=i.tcFloatBox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!1,refresh:"fixed",width:"70%",height:"70%",top:"15%",left:"15%",classname:"flasho tm_wrapper tc-builder-add-element",data:n});e&&e.preventDefault(),i(".tc-builder-add-element .tc-element-button").on("click.cpf",function(e){var n=t.closest(".builder_wrapper"),l=i(this).attr("data-element");e.preventDefault(),t.is(".tc-prepend")?i.tmEPOAdmin.builder_clone_element(l,n,"prepend"):i.tmEPOAdmin.builder_clone_element(l,n),i.tmEPOAdmin.logic_reindex(),a.destroy()})},builder_add_section_and_element_onClick:function(e){var t=i.tmEPOAdmin.builder_floatbox_template_import({id:"temp_for_floatbox_insert",html:'<div class="tm-inner">'+m.element_data+"</div>",title:m.i18n_add_element}),n=i.tcFloatBox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!1,refresh:"fixed",width:"70%",height:"70%",top:"15%",left:"15%",classname:"flasho tm_wrapper tc-builder-add-section-and-element",data:t});e&&e.preventDefault(),i(".tc-builder-add-section-and-element .tc-element-button").on("click.cpf",function(e){var t,a=i.tmEPOAdmin.builder_add_section_onClick(!1,!0);e.preventDefault(),a&&(t=i(this).attr("data-element"),i.tmEPOAdmin.builder_clone_element(t,a),i.tmEPOAdmin.logic_reindex(),n.destroy())})},tm_variations_check_for_changes:0,tm_variations_check:function(){var e;i(".builder_layout .element-variations").length&&1===i.tmEPOAdmin.tm_variations_check_for_changes&&s&&(i("#tm_extra_product_options").block({message:null,overlayCSS:{background:"#fff url("+s.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}}),e={action:"woocommerce_tm_variations_check",post_id:s.post_id,security:s.check_attributes_nonce},i.post(s.ajax_url,e,function(e){i(".tma-variations-wrap .tm-all-attributes").html(e),i("#tm_extra_product_options").unblock(),i("#tm_extra_product_options").trigger("woocommerce_tm_variations_check_loaded"),i.tmEPOAdmin.tm_variations_check_for_changes=0,i.tmEPOAdmin.builder_reorder_multiple()}))},builder_variation_delete_onClick:function(){i.tmEPOAdmin.var_is("tm-style-variation-forced",!0),i(".builder_add_section").addClass("inline"),i(".builder_add_variation").addClass("inline").removeClass("tm-hidden"),2===i(".tma-variations-wrap").length&&i(".tma-variations-wrap").eq(1).remove(),i(".tma-variations-wrap").addClass("tm-hidden"),i(".tma-variations-wrap").find(".tm-variations-disabled").val("1"),i.tmEPOAdmin.init_sections_check()},builder_add_variation_onClick:function(e){var t,n,a,l;e&&e.preventDefault(),!0!==i.tmEPOAdmin.var_is("tm-style-variation-added")?(t=i.epoAPI.template.html(b.tc_builder_section,{}))&&(n=i(t))&&(n.addClass("w100"),n.addClass("appear"),n.find(".tm-builder-sections-uniqid").val(i.tm_uniqid("",!0)),n.find(".tm-add-element-action,.tmicon.clone,.tmicon.size,.tmicon.move,.tmicon.plus,.tmicon.minus").remove(),n.addClass("tma-nomove tma-variations-wrap"),n.find(".builder_hide_for_variation").hide(),(a=n.find(".tma-tab-logic,.tma-tab-css,.tma-tab-woocommerce")).hide(),n.prependTo(".builder_layout"),i.tmEPOAdmin.gen_events(n),n.find(".tm-tabs").tmtabs(),i.tmEPOAdmin.check_section_logic(n),i.tmEPOAdmin.logic_init(n),i.tmEPOAdmin.init_sections_check(),i.tmEPOAdmin.fix_content_float(),i.tmEPOAdmin.var_is("tm-style-variation-added",!0),l=i.tmEPOAdmin.builder_clone_element("variations",i(".builder_layout").find(".builder_wrapper").first()),!0===i.tmEPOAdmin.var_is("tm-style-variation-forced")?(i(".builder_add_section").addClass("inline"),i(".builder_add_variation").addClass("inline").removeClass("tm-hidden"),i(".tma-variations-wrap").addClass("tm-hidden"),i(".tma-variations-wrap").find(".tm-variations-disabled").val("1")):(i(".builder_add_variation").addClass("tm-hidden"),i(".builder_add_section").removeClass("inline"),i(".tma-variations-wrap").removeClass("tm-hidden"),i.tmEPOAdmin.var_is("tm-style-variation-forced",!1),i(".tma-variations-wrap").find(".tm-variations-disabled").val("")),l.find(".tmicon.size,.tmicon.clone,.tmicon.move,.tmicon.plus,.tmicon.minus,.tmicon.delete").remove(),a=l.find(".tma-tab-logic,.tma-tab-css,.tma-tab-woocommerce"),l.addClass("tma-nomove"),l.find(".builder_hide_for_variation").hide(),a.hide(),i.tmEPOAdmin.logic_reindex_force(),i.tmEPOAdmin.tm_variations_check_for_changes=1,i.tmEPOAdmin.tm_variations_check()):!0===i.tmEPOAdmin.var_is("tm-style-variation-forced")&&(i.tmEPOAdmin.var_is("tm-style-variation-forced",!1),i(".builder_add_variation").addClass("tm-hidden"),i(".builder_add_section").removeClass("inline"),i(".tma-variations-wrap").removeClass("tm-hidden"),i(".tma-variations-wrap").find(".tm-variations-disabled").val(""),i.tmEPOAdmin.init_sections_check())},var_is:function(e,t){return t?void i("body").data(e,t):i("body").data(e)},var_remove:function(e){e&&i("body").removeData(e)},element_logic_object:{},logic_object:{},logic_operators:{is:m.i18n_is,isnot:m.i18n_is_not,isempty:m.i18n_is_empty,isnotempty:m.i18n_is_not_empty,startswith:m.i18n_starts_with,endswith:m.i18n_ends_with,greaterthan:m.i18n_greater_than,lessthan:m.i18n_less_than},tm_escape:function(e){return encodeURIComponent(e)},tm_unescape:function(e){return decodeURIComponent(e)},get_element_logic_init:function(e){return i.tmEPOAdmin.pre_element_logic_init_done||i.tmEPOAdmin.pre_element_logic_init(e),i.tmEPOAdmin.isinit?i.tmEPOAdmin.pre_element_logic_init_done=!0:i.tmEPOAdmin.pre_element_logic_init_done=!1,i.tmEPOAdmin.pre_element_logic_init_obj},get_element_logic_options_init:function(e){return i.tmEPOAdmin.pre_element_logic_init_done||i.tmEPOAdmin.pre_element_logic_init(e),i.tmEPOAdmin.isinit?i.tmEPOAdmin.pre_element_logic_init_done=!0:i.tmEPOAdmin.pre_element_logic_init_done=!1,i.tmEPOAdmin.pre_element_logic_init_obj_options},find_index:function(e,t,i,n){var a,l=0;return e&&(l=t.closest(".bitem_wrapper").prevAll(".bitem_wrapper").find(".bitem").length),i&&n?(a=t.parent().find(i).not(n),parseInt(l,10)+parseInt(a.index(t),10)):parseInt(l,10)+parseInt(t.index(),10)},setGlobalVariationObject:function(t,n){var a,l;s?(i("#tm_extra_product_options").block({message:null,overlayCSS:{background:"#fff url("+s.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}}),a={action:"woocommerce_tm_get_variations_array",post_id:s.post_id,security:s.check_attributes_nonce},l=e.ajaxurl||s.ajax_url,i.post(l,a,function(e){e&&(f=e,!0===t?i.tmEPOAdmin.pre_element_logic_init_set(n):"reindex"===t?i.tmEPOAdmin.logic_reindex_force():"initialitize_on"===t?i.tmEPOAdmin.initialitize_on():"initialitize_on_after"===t&&i.tmEPOAdmin.initialitize_on_after())},"json").always(function(){i("#tm_extra_product_options").unblock()})):"initialitize_on"===t?(f||(f={}),i.tmEPOAdmin.initialitize_on()):"initialitize_on_after"===t&&(f||(f={}),i.tmEPOAdmin.initialitize_on_after())},pre_element_logic_init:function(e){f?i.tmEPOAdmin.pre_element_logic_init_set(e):i.tmEPOAdmin.setGlobalVariationObject(!0,e)},pre_element_logic_init_set:function(e){var t,n,a,l,o,r,d,s,m,c,_,p,u,b,v,h,g,A,O,w,P;f&&(i.tmEPOAdmin.pre_element_logic_init_obj={},i.tmEPOAdmin.pre_element_logic_init_obj_options={},t={},n={},a=i(".builder_layout .builder_wrapper"),l=[],a.each(function(a,E){E=i(E),o=E.find(".tm-builder-sections-uniqid").val(),-1!==l.indexOf(o)&&(E.find(".tm-builder-sections-uniqid").val(i.tm_uniqid("",!0)),o=E.find(".tm-builder-sections-uniqid").val()),l.push(o),t[o]=[],e&&i.tmEPOAdmin.check_section_logic(E),P=E.find(".tm-internal-name").val()||"Section",E.is(".tma-variations-wrap")||(t[o][0]='<option data-type="section" data-section="'+o+'" value="'+o+'">'+P+" ("+o+")</option>"),r=E.find(i.tmEPOAdmin.can_take_logic()).not(".element_is_disabled"),d=[],s=E.is(".tm-slider-wizard"),m=[],r.each(function(e,n){if(n=i(n),c=n.find('[name^="tm_meta\\[tmfbuilder\\]\\["][name$="_header_title\\]\\[\\]"]'),_=i.tmEPOAdmin.find_index(s,n,".bitem",".element_is_disabled"),p=n.find(".is_enabled"),u="1"===n.find(".is_enabled").val(),p.length&&!u)return!0;1===c.length&&(0===(b=c.val()).length&&(b=c.closest(".bitem").find(".tm-label").text()),(v=c.closest(".bitem").find(".tm-internal-name").val())!==b&&(b=b+" ("+v+")"),h=n.is(".element-variations")?"variation":n.is(".element-radiobuttons,.element-checkboxes,.element-selectbox")?"multiple":"text",t[o][_+1]='<option data-type="'+h+'" data-section="'+o+'" value="'+_+'">'+b+"</option>",n.is(".element-variations")?(m=[],i(f.variations).each(function(e,t){g=[],i(t.attributes).each(function(e,t){var n=i.map(t,function(e){return e});i(n).each(function(e,t){g.push(t)})}),g=g.join(" - "),A=g;try{A=i.tmEPOAdmin.tm_unescape(g)}catch(e){A=g}m.push('<option value="'+i.tmEPOAdmin.tm_escape(t.variation_id)+'">'+A+"</option>")}),d[_]='<select data-element="'+_+'" data-section="'+o+'" class="cpf-logic-value">'+m.join("")+"</select>"):n.is(".element-radiobuttons,.element-checkboxes,.element-selectbox")?(O=n.find(".tm_option_title"),w=n.find(".tm_option_value"),m=[],O.each(function(e,t){m.push('<option value="'+i.tmEPOAdmin.tm_escape(i(w[e]).val())+'">'+i(t).val()+"</option>")}),d[_]='<select data-element="'+_+'" data-section="'+o+'" class="cpf-logic-value">'+m.join("")+"</select>"):d[_]='<input data-element="'+_+'" data-section="'+o+'" class="cpf-logic-value" type="text" value="">')}),n[o]={values:d}}),i.tmEPOAdmin.pre_element_logic_init_obj=n,i.tmEPOAdmin.pre_element_logic_init_obj_options=t)},element_logic_init:function(e){var t,n,a,l,o=i(e),r=o.closest(".builder_wrapper").is(".tm-slider-wizard"),d=i.tmEPOAdmin.find_index(r,o,".bitem",".element_is_disabled"),s=[];i.tmEPOAdmin.check_section_logic(),i.tmEPOAdmin.check_element_logic(o),a=i.extend(!0,{},i.tmEPOAdmin.get_element_logic_init()),l=i.extend(!0,{},i.tmEPOAdmin.get_element_logic_options_init()),n=(t=o.closest(".builder_layout .builder_wrapper")).find(".tm-builder-sections-uniqid").val(),t&&n&&a[n]&&a[n].values[d]?(delete a[n].values[d],delete l[n][d+1],delete l[n][0]):t&&n&&l[n]&&l[n][0]&&delete l[n][0],i.each(l,function(e,t){t&&i.each(t,function(e,t){t&&s.push(t)})}),i.tmEPOAdmin.element_logic_object.init||(i.tmEPOAdmin.element_logic_object.init=!0),i.tmEPOAdmin.element_logic_object=i.extend(i.tmEPOAdmin.element_logic_object,a),i.tmEPOAdmin.logic_append(e,s)},logic_init:function(e){var t,n,a=[],l={};e=i(e),i.tmEPOAdmin.check_section_logic(e),l=i.extend(!0,{},i.tmEPOAdmin.get_element_logic_init(!0)),t=i.extend(!0,{},i.tmEPOAdmin.get_element_logic_options_init(!0)),n=e.find(".tm-builder-sections-uniqid").val(),e&&n&&l[n]&&(delete l[n],delete t[n]),i.each(t,function(e,t){t&&i.each(t,function(e,t){t&&a.push(t)})}),i.tmEPOAdmin.logic_object.init||(i.tmEPOAdmin.logic_object.init=!0),i.tmEPOAdmin.logic_object=i.extend(i.tmEPOAdmin.logic_object,l),i.tmEPOAdmin.logic_append(e,a)},logic_check_section_rules:function(e){var t,n;return"object"==typeof e&&null!==e||(e={}),"toggle"in e||(e.toggle="show"),"what"in e||(e.what="any"),"rules"in e||(e.rules=[]),t=e,n=i.tmEPOAdmin.logic_object,i.each(e.rules,function(e,i){var a=i.section,l=i.element;a in n&&l in n[a].values||a===l||delete t.rules[e]}),t.rules=i.tm_array_values(t.rules),t},logic_check_element_rules:function(e){var t,n;return"object"==typeof e&&e||(e={}),"toggle"in e||(e.toggle="show"),"what"in e||(e.what="any"),"rules"in e||(e.rules=[]),t=e,n=i.tmEPOAdmin.element_logic_object,i.each(e.rules,function(e,i){var a=i.section,l=i.element;a in n&&l in n[a].values||(a=l)||delete t.rules[e]}),t.rules=i.tm_array_values(t.rules),t},logic_append:function(e,t){var n,a,l,o,r,d,s,c,_,p,u,f;if(e=i(e),n=e.is(".bitem")?e.find(".builder_element_wrap"):e.find(".section_elements"),a=i(n).find(".tm-logic-wrapper"),!t||0===t.length)return a.html('<div class="errortitle"><p>'+m.i18n_cannot_apply_rules+"</p></div>"),!1;try{l="1"===(e.is(".bitem")?i(n).find(".activate-element-logic").val()||"":i(n).find(".activate-sections-logic").val()||"")?i(n).find(".tm-builder-clogic").val()||"null":"null",o=i.epoAPI.util.parseJSON(l),f=e.is(".bitem")?i.tmEPOAdmin.logic_check_element_rules(o):i.tmEPOAdmin.logic_check_section_rules(o),i(n).find(".tm-builder-clogic").val(v.stringify(f))}catch(e){f=!1}a.empty(),r=i('<div class="tm-row nopadding tm-logic-rule"><div class="tm-cell col-4 tm-logic-element"></div><div class="tm-cell col-2 tm-logic-operator"></div><div class="tm-cell col-4 tm-logic-value"></div><div class="tm-cell col-2 tm-logic-func"><button type="button" class="tc tc-button cpf-add-rule"><i class="tcfa tcfa-plus"></i></button> <button type="button" class="tc tc-button cpf-delete-rule"><i class="tcfa tcfa-times"></i></button></div></div>'),d=i('<select class="cpf-logic-element">'+t.join("")+"</select>"),s="";for(c in i.tmEPOAdmin.logic_operators)i.tmEPOAdmin.logic_operators.hasOwnProperty(c)&&(s=s+'<option value="'+c+'">'+i.tmEPOAdmin.logic_operators[c]+"</option>");s=i('<select class="cpf-logic-operator">'+s+"</select>"),r.find(".tm-logic-element").append(d),r.find(".tm-logic-operator").append(s),f&&"rules"in f&&f.rules.length?(_=i('<div class="temp">'),i.each(f.rules,function(t,n){n&&"object"==typeof n&&(p=r.clone(),u=p.find(".cpf-logic-element").find('option[data-section="'+n.section+'"][value="'+n.element+'"]'),i(u).length&&(i(u)[0].selected=!0),i.tmEPOAdmin.cpf_logic_element_onchange(p.find(".cpf-logic-element"),e.is(".bitem")),p.find(".cpf-logic-operator").val(n.operator),i.tmEPOAdmin.cpf_logic_operator_onchange(p.find(".cpf-logic-operator"),e.is(".bitem")),p.find(".cpf-logic-value").is("select")?p.find(".cpf-logic-value").val(i.tmEPOAdmin.tm_escape(i.tmEPOAdmin.tm_unescape(n.value))):p.find(".cpf-logic-value").val(i.tmEPOAdmin.tm_unescape(n.value)),_.append(p))}),_=_.children(),a.append(_)):(r.appendTo(a).find(".cpf-logic-element").trigger("change.cpf",[e.is(".bitem")]),r.appendTo(a).find(".cpf-logic-operator").trigger("change.cpf",[e.is(".bitem")]))},logic_get_JSON:function(e){var t,n,a,l,o,r=i(e).find(".builder-logic-div"),d=e.find(".tm-builder-sections-uniqid").val(),s={},m=r.find(".epo-rule-toggle").val(),c=r.find(".epo-rule-what").val();return s.section=d,s.toggle=m,s.what=c,s.rules=[],r.find(".tm-logic-wrapper").children(".tm-logic-rule").each(function(e,r){r=i(r),t=r.find(".cpf-logic-element"),n=t.children("option:selected").attr("data-section"),a=t.val(),l=r.find(".cpf-logic-operator").val(),o=r.find(".cpf-logic-value").val(),r.find(".cpf-logic-value").is("select")||(o=i.tmEPOAdmin.tm_escape(o)),s.rules.push({section:n,element:a,operator:l,value:o})}),v.stringify(s)},element_logic_get_JSON:function(e){var t,n,a,l,o,r=i(e).find(".builder-logic-div"),d=e.find(".tm-builder-element-uniqid").val(),s={},m=r.find(".epo-rule-toggle").val(),c=r.find(".epo-rule-what").val();return s.element=d,s.toggle=m,s.what=c,s.rules=[],r.find(".tm-logic-wrapper").children(".tm-logic-rule").each(function(e,r){r=i(r),t=r.find(".cpf-logic-element"),n=t.children("option:selected").attr("data-section"),a=t.val(),l=r.find(".cpf-logic-operator").val(),o=r.find(".cpf-logic-value").val(),s.rules.push({section:n,element:a,operator:l,value:o})}),v.stringify(s)},cpf_add_rule:function(e){var t=i(this).closest(".tm-logic-rule"),n=t.tcClone(!0);e.preventDefault(),n&&t.after(n)},cpf_delete_rule:function(e){var t=i(this),n=t.closest(".tm-logic-wrapper");e.preventDefault(),t.trigger("hideTtooltip"),n.children().length>1&&t.closest(".tm-logic-rule").css({margin:"0 auto"}).animate({opacity:0,height:0,width:0},300,function(){i(this).remove()})},builder_items_sortable_obj:{start:{},end:{}},section_logic_reindex:function(){var e=i.tmEPOAdmin.builder_items_sortable_obj;i(".builder_layout .builder_wrapper").each(function(t,n){var a,l=i(n).find(".section_elements"),o=i(n).index(),r=[],d=i(l).find(".tm-builder-clogic").val()||"null";if(!((d=i.epoAPI.util.parseJSON(d))&&"rules"in d&&d.rules.length>0))return!0;e.end.section_eq===o?(i.each(d.rules,function(t,l){a=l,l.element>e.start.element&&l.secion===e.start.section?(a.element=parseInt(a.element,10)-1,r[t]=i.tmEPOAdmin.validate_rule(a,i(n))):r[t]=i.tmEPOAdmin.validate_rule(a,i(n))}),0===(r=i.tm_array_values(r)).length&&i(l).find(".activate-sections-logic").val("").trigger("change.cpf"),d.rules=r,i(l).find(".tm-builder-clogic").val(v.stringify(d))):(i.each(d.rules,function(t,l){a=l,"check"!==e.start.section&&(l.section===e.start.section&&l.section===e.end.section?l.element===e.start.element?(a.section=e.end.section,a.element=e.end.element):parseInt(l.element,10)>parseInt(e.start.element,10)&&parseInt(l.element,10)<=parseInt(e.end.element,10)?a.element=parseInt(a.element,10)-1:parseInt(l.element,10)<parseInt(e.start.element,10)&&parseInt(l.element,10)>=parseInt(e.end.element,10)&&(a.element=parseInt(a.element,10)+1):l.section===e.start.section&&l.section!==e.end.section?l.element===e.start.element?(a.section=e.end.section,a.element=e.end.element):parseInt(l.element,10)>parseInt(e.start.element,10)&&(a.element=parseInt(a.element,10)-1):l.section!==e.start.section&&l.section===e.end.section&&parseInt(l.element,10)>=parseInt(e.end.element,10)&&(a.element=parseInt(a.element,10)+1)),"delete"===e.end.section&&"delete"===a.element||(r[t]=i.tmEPOAdmin.validate_rule(a,i(n)))}),0===(r=i.tm_array_values(r)).length&&i(l).find(".activate-sections-logic").val("").trigger("change.cpf"),d.rules=r,i(l).find(".tm-builder-clogic").val(v.stringify(d)))})},element_logic_reindex:function(){var e,t,n,a,l=i.tmEPOAdmin.builder_items_sortable_obj;i(".bitem").each(function(o,r){if(t=i(r).find(".builder_element_wrap"),n=[],a=i(t).find(".tm-builder-clogic").val()||"null",!((a=i.epoAPI.util.parseJSON(a))&&"rules"in a&&a.rules.length>0))return!0;i.each(a.rules,function(t,a){e=a,"check"!==l.start.section&&(a.section===l.start.section&&a.section===l.end.section?a.element===l.start.element?e.element=l.end.element:parseInt(a.element,10)>parseInt(l.start.element,10)&&parseInt(a.element,10)<=parseInt(l.end.element,10)?e.element=parseInt(e.element,10)-1:parseInt(a.element,10)<parseInt(l.start.element,10)&&parseInt(a.element,10)>=parseInt(l.end.element,10)&&(e.element=parseInt(e.element,10)+1):a.section===l.start.section&&a.section!==l.end.section?a.element===l.start.element?(e.section=l.end.section,e.element=l.end.element):parseInt(a.element,10)>parseInt(l.start.element,10)&&(e.element=parseInt(e.element,10)-1):a.section!==l.start.section&&a.section===l.end.section&&parseInt(a.element,10)>=parseInt(l.end.element,10)&&(e.element=parseInt(e.element,10)+1)),"delete"===l.end.section&&"delete"===e.element||(n[t]=i.tmEPOAdmin.validate_rule(e,i(r)))}),0===(n=i.tm_array_values(n)).length&&i(t).find(".activate-element-logic").val("").trigger("change.cpf"),a.rules=n,i(t).find(".tm-builder-clogic").val(v.stringify(a))})},validate_rule:function(e,t){var n,a,l;return f&&e&&"object"==typeof e&&"element"in e&&"operator"in e&&"section"in e&&"value"in e?(n=i(".tm-builder-sections-uniqid[value='"+e.section+"']").closest(".builder_wrapper"),a=i(n).find(".bitem_wrapper").children(".bitem").not(".element_is_disabled").eq(e.element),l=!1,i(a).is(".element-radiobuttons,.element-checkboxes,.element-selectbox")?i(a).find(".tm_option_value").each(function(t,n){return i.tmEPOAdmin.tm_escape(i(n).val())===e.value?(l=!0,!1):i(n).val()===e.value?(e.value=i.tmEPOAdmin.tm_escape(e.value),l=!0,!1):void 0}):i(a).is(".element-variations")&&("is"===e.operator||"isnot"===e.operator)?i(f.variations).each(function(t,n){if(i.tmEPOAdmin.tm_escape(n.variation_id)===e.value)return l=!0,!1}):l=!0,l||""===i(t).find(".activate-element-logic").val()?(i(t).removeClass("tm-wrong-rule"),e):(i(t).addClass("tm-wrong-rule"),[])):[]},logic_reindex:function(){var e=i.tmEPOAdmin.builder_items_sortable_obj;e.start.section===e.end.section&&e.start.section_eq===e.end.section_eq&&e.start.element===e.end.element||(i.tmEPOAdmin.section_logic_reindex(),i.tmEPOAdmin.element_logic_reindex()),i.tmEPOAdmin.builder_items_sortable_obj={start:{},end:{}}},logic_reindex_force:function(){i.tmEPOAdmin.builder_items_sortable_obj.start.section="check",i.tmEPOAdmin.builder_items_sortable_obj.start.section_eq="check",i.tmEPOAdmin.builder_items_sortable_obj.start.element="check",i.tmEPOAdmin.builder_items_sortable_obj.end.section="check2",i.tmEPOAdmin.builder_items_sortable_obj.end.section_eq="check2",i.tmEPOAdmin.builder_items_sortable_obj.end.element="check2",i.tmEPOAdmin.section_logic_reindex(),i.tmEPOAdmin.element_logic_reindex(),i.tmEPOAdmin.builder_items_sortable_obj={start:{},end:{}}},is_element_dragged:!1,builder_items_sortable:function(e){i.tmEPOAdmin.is_original&&e.sortable({handle:".move",cursor:"move",items:".bitem",start:function(e,t){var n,a,l;t.placeholder.height(t.helper.outerHeight()),t.placeholder.width(t.helper.outerWidth()),i.tmEPOAdmin.is_element_dragged=!0,i(t.item).hasClass("ditem")?(i.tmEPOAdmin.builder_items_sortable_obj.start.section="drag",i.tmEPOAdmin.builder_items_sortable_obj.start.section_eq="drag",i.tmEPOAdmin.builder_items_sortable_obj.start.element="drag"):(a=(n=i(t.item).closest(".builder_wrapper")).is(".tm-slider-wizard"),l=i.tmEPOAdmin.find_index(a,i(t.item)),n.addClass("tm-zindex").css("zIndex",3),n.find(".tm_builder_sections").val(function(e,t){return t=parseInt(t,10)-1}),n.find(".tm_builder_section_slides").val(function(){return n.is(".tm-slider-wizard")?n.find(".bitem_wrapper").map(function(e,t){return i(t).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}),i.tmEPOAdmin.builder_items_sortable_obj.start.section=n.find(".tm-builder-sections-uniqid").val(),i.tmEPOAdmin.builder_items_sortable_obj.start.section_eq=n.index().toString(),i.tmEPOAdmin.builder_items_sortable_obj.start.element=l.toString()),i(".builder_layout .bitem_wrapper").not(".tma-variations-wrap .bitem_wrapper").addClass("highlight")},stop:function(e,t){var n,a,l;i.tmEPOAdmin.is_element_dragged=!1,a=(n=i(t.item).closest(".builder_wrapper")).is(".tm-slider-wizard"),l=i.tmEPOAdmin.find_index(a,i(t.item)),i(t.item).hasClass("ditem")||(i(".builder_wrapper.tm-zindex").css("zIndex","").removeClass("tm-zindex"),n.find(".tm_builder_sections").val(function(e,t){return t=parseInt(t,10)+1}),n.find(".tm_builder_section_slides").val(function(){return n.is(".tm-slider-wizard")?n.find(".bitem_wrapper").map(function(e,t){return i(t).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""})),i.tmEPOAdmin.builder_items_sortable_obj.end.section=n.find(".tm-builder-sections-uniqid").val(),i.tmEPOAdmin.builder_items_sortable_obj.end.section_eq=n.index().toString(),i.tmEPOAdmin.builder_items_sortable_obj.end.element=l.toString(),i.tmEPOAdmin.builder_reorder_multiple(),i(t.item).hasClass("ditem")&&(t.draggable=t.item,i.tmEPOAdmin.drag_drop(e,t,i(this))),i.tmEPOAdmin.logic_reindex(),i(".builder_layout .bitem_wrapper").removeClass("highlight")},tolerance:"pointer",forcePlaceholderSize:!0,placeholder:"bitem pl2",forceHelperSize:!0,helper:"clone",cancel:".panels_wrap,.tma-nomove",dropOnEmptyType:!0,revert:200,connectWith:".builder_wrapper:not(.tma-nomove) .bitem_wrapper"})},builder_delete_onClick:function(){var e,t,n,a;c(m.i18n_builder_delete)&&(e=i(this).closest(".builder_wrapper"),t=i(this).closest(".bitem"),n=e.is(".tm-slider-wizard"),a=i.tmEPOAdmin.find_index(n,t),e.find(".tm_builder_sections").val(function(e,t){return t=parseInt(t,10)-1}),i.tmEPOAdmin.builder_items_sortable_obj.start.section=e.find(".tm-builder-sections-uniqid").val(),i.tmEPOAdmin.builder_items_sortable_obj.start.section_eq=e.index().toString(),i.tmEPOAdmin.builder_items_sortable_obj.start.element=a.toString(),i.tmEPOAdmin.builder_items_sortable_obj.end.section="delete",i.tmEPOAdmin.builder_items_sortable_obj.end.section_eq="delete",i.tmEPOAdmin.builder_items_sortable_obj.end.element="delete",i(this).closest(".bitem").remove(),i.tmEPOAdmin.logic_reindex(),e.find(".tm_builder_section_slides").val(function(){return e.is(".tm-slider-wizard")?e.find(".bitem_wrapper").map(function(e,t){return i(t).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}),i.tmEPOAdmin.builder_reorder_multiple())},builder_fold_onClick:function(){var e,t=i(this);t.is(".tma-handle")&&(t=t.find(".fold")),e=t.closest(".tma-handle-wrap").find(".tma-handle-wrapper").first(),t.data("folded")||void 0===t.data("folded")?(t.data("folded",!1),t.removeClass("tcfa-caret-up").addClass("tcfa-caret-down"),e.removeClass("tm-hidden")):(t.data("folded",!0),t.removeClass("tcfa-caret-down").addClass("tcfa-caret-up"),e.addClass("tm-hidden"))},builder_section_fold_onClick:function(){var e=i(this).closest(".builder_wrapper");i(this).data("folded")?(i(this).data("folded",!1),e.removeClass("tm-hide-bitems"),i(this).removeClass("tcfa-caret-up").addClass("tcfa-caret-down")):(i(this).data("folded",!0),e.addClass("tm-hide-bitems"),i(this).removeClass("tcfa-caret-down").addClass("tcfa-caret-up")),i(this).closest(".builder_wrapper").find(".float.builder_drag_elements").remove()},builder_section_delete_onClick:function(){c(m.i18n_builder_delete)&&(i(this).closest(".builder_wrapper").remove(),i.tmEPOAdmin.builder_reorder_multiple(),i(".builder_layout .builder_wrapper").each(function(e,t){i.tmEPOAdmin.logic_init(i(t))}),i.tmEPOAdmin.init_sections_check(),i.tmEPOAdmin.fix_content_float(),i(this).closest(".builder_wrapper").is(".tma-variations-wrap")&&(i.tmEPOAdmin.toggle_variation_button(),i.tmEPOAdmin.var_remove("tm-style-variation-added")))},builder_plus_onClick:function(){var e,t=i.tmEPOAdmin.builder_size(),n=i(this).parentsUntil(".bitem").parent().first();for(e in t)if(n.hasClass(t[e][0])){e<5&&(n.removeClass(""+t[e][0]),n.addClass(""+t[parseInt(parseInt(e,10)+1,10)][0]),n.find(".size").text(t[parseInt(parseInt(e,10)+1,10)][1]),n.find(".div_size").val(t[parseInt(parseInt(e,10)+1,10)][0]));break}},builder_minus_onClick:function(){var e,t=i.tmEPOAdmin.builder_size(),n=i(this).parentsUntil(".bitem").parent().first();for(e in t)if(n.hasClass(t[e][0])){e>0&&(n.removeClass(""+t[e][0]),n.addClass(""+t[parseInt(parseInt(e,10)-1,10)][0]),n.find(".size").text(t[parseInt(parseInt(e,10)-1,10)][1]),n.find(".div_size").val(t[parseInt(parseInt(e,10)-1,10)][0]));break}},builder_section_plus_onClick:function(){var e,t=i.tmEPOAdmin.builder_size(),n=i(this).closest(".builder_wrapper");for(e in t)if(n.hasClass(t[e][0])){e<5&&(n.removeClass(""+t[e][0]),n.addClass(""+t[parseInt(parseInt(e,10)+1,10)][0]),n.find(".btitle .size").text(t[parseInt(parseInt(e,10)+1,10)][1]),n.find(".tm_builder_sections_size").val(t[parseInt(parseInt(e,10)+1,10)][0]));break}},builder_section_minus_onClick:function(){var e,t=i.tmEPOAdmin.builder_size(),n=i(this).closest(".builder_wrapper");for(e in t)if(n.hasClass(t[e][0])){e>0&&(n.removeClass(""+t[e][0]),n.addClass(""+t[parseInt(parseInt(e,10)-1,10)][0]),n.find(".btitle .size").text(t[parseInt(parseInt(e,10)-1,10)][1]),n.find(".tm_builder_sections_size").val(t[parseInt(parseInt(e,10)-1,10)][0]));break}},builder_section_item_onClick:function(){var e,t,n,a,l,o,r=i(this).closest(".builder_wrapper");i.tmEPOAdmin.check_section_logic(r),e=i.tmEPOAdmin.logic_object,i.tmEPOAdmin.logic_init(r),(n=(t=i(this).closest(".builder_wrapper").find(".section_elements")).find(".tm-tabs")).data("tm-has-tmtabs")||n.tmtabs(),a=t.tcClone(),i.tmEPOAdmin.gen_events(r),l=i.tmEPOAdmin.builder_floatbox_template({id:"temp_for_floatbox_insert",html:"",title:m.i18n_edit_settings,uniqid:m.i18n_section_uniqid+":"+t.find(".tm-builder-sections-uniqid").val()}),i.tcFloatBox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!0,refresh:"fixed",width:"80%",height:"80%",classname:"flasho tm_wrapper"+(r.is(".tma-variations-wrap")?" tma-variations-section":""),data:l,cancelEvent:function(t){o||(o=!0,i.tmEPOAdmin.logic_object=e,i.tmEPOAdmin.removeTinyMCE(".flasho.tm_wrapper"),a.prependTo(r).addClass("closed"),i.tmEPOAdmin.builder_clone_after_events(a),t.destroy())},cancelClass:".floatbox-cancel",updateEvent:function(e){o||(o=!0,i.tmEPOAdmin.removeTinyMCE(".flasho.tm_wrapper"),t.find(".tm-builder-clogic").val(i.tmEPOAdmin.logic_get_JSON(t)),t.prependTo(r).addClass("closed"),i.tmEPOAdmin.builder_clone_after_events(t),r.trigger("sections_type_onChange.cpf"),i.tmEPOAdmin.logic_reindex_force(),e.destroy())},updateClass:".floatbox-update"}),o=!1,t.appendTo("#temp_for_floatbox_insert").removeClass("closed"),t.find(".sections_style").trigger("change.cpf"),i.tmEPOAdmin.addTinyMCE(".flasho.tm_wrapper")},builder_item_onClick:function(){var e,t,n,a,l,o,r,d,s=i(this).closest(".bitem"),c=s.find(".tm-tabs");c.data("tm-has-tmtabs")||c.tmtabs(),i.tmEPOAdmin.panels_sortable(s.find(".panels_wrap")),i.tmEPOAdmin.check_element_logic(s),e=i.tmEPOAdmin.element_logic_object,i.tmEPOAdmin.element_logic_init(s),t=i(this).closest(".hstc2"),n=i(this).closest(".hstc2").find(".inside:first"),a=n.tcClone(),l=n.find(".is_enabled").val(),i.tmEPOAdmin.gen_events(s),o=i.tmEPOAdmin.builder_floatbox_template({id:"temp_for_floatbox_insert",html:"",title:m.i18n_edit_settings,uniqid:s.is(".element-variations")||0===s.find(".tm-builder-element-uniqid").length?"":m.i18n_element_uniqid+":"+s.find(".tm-builder-element-uniqid").val()}),i.tcFloatBox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!0,refresh:"fixed",width:"80%",height:"80%",classname:"flasho tm_wrapper"+(t.is(".tma-variations-wrap")?" tma-variations-section":""),data:o,cancelEvent:function(n){r||(r=!0,(d=a.find(".tcpagination")).data("tc-pagination")&&d.tcPagination("destroy"),i.tmEPOAdmin.element_logic_object=e,i.tmEPOAdmin.removeTinyMCE(".flasho.tm_wrapper"),a.appendTo(t),a=a.parentsUntil(".bitem").parent(),i.tmEPOAdmin.builder_clone_after_events(a),n.destroy())},cancelClass:".floatbox-cancel",updateEvent:function(e){var a,o,m,c,_,p,u,f,b,h;r||(r=!0,(d=n.find(".tcpagination")).data("tc-pagination")&&d.tcPagination("destroy"),i.tmEPOAdmin.removeTinyMCE(".flasho.tm_wrapper"),n.find(".tm-builder-clogic").val(i.tmEPOAdmin.element_logic_get_JSON(n)),n.appendTo(t),i.tmEPOAdmin.builder_clone_after_events(n),n.find(".tm-header-title").trigger("changetitle.cpf"),i.tmEPOAdmin.logic_reindex_force(),"0"===n.find(".is_enabled").val()?s.addClass("element_is_disabled"):s.removeClass("element_is_disabled"),a=n.find(".is_enabled").val(),l!==a&&(o=s.closest(".builder_wrapper"),m=i(".builder_layout .builder_wrapper").not(o),c=o.find(".tm-builder-sections-uniqid").val(),_=o.is(".tm-slider-wizard"),p=i.tmEPOAdmin.find_index(_,s),u=i.tmEPOAdmin.find_index(_,s,".bitem",".element_is_disabled"),o.find(".bitem").not(s).each(function(e,t){t=i(t),f=t.find(".tm-builder-clogic").val()||"null",f=i.epoAPI.util.parseJSON(f),f=i.tmEPOAdmin.logic_check_rules_reindex(t,f,p,u,c,a),t.find(".tm-builder-clogic").val(v.stringify(f))}),m.each(function(e,t){t=i(t),b=t.find(".section_elements"),h=b.find(".tm-builder-clogic").val()||"null",h=i.epoAPI.util.parseJSON(h),h=i.tmEPOAdmin.logic_check_rules_reindex(t,h,p,u,c,a),b.find(".tm-builder-clogic").val(v.stringify(h)),t.find(".bitem").not(s).each(function(e,n){n=i(n),f=n.find(".tm-builder-clogic").val()||"null",f=i.epoAPI.util.parseJSON(f),f=i.tmEPOAdmin.logic_check_rules_reindex(t,f,p,u,c,a),n.find(".tm-builder-clogic").val(v.stringify(f))})})),e.destroy())},updateClass:".floatbox-update"}),r=!1,n.appendTo("#temp_for_floatbox_insert"),s.is(".element-variations")?i.tmEPOAdmin.variations_display_as():i.tmEPOAdmin.tm_upload(),i("#temp_for_floatbox_insert").find(".tm_select_price_type").trigger("change.cpf"),i.tcToolTip(i("#temp_for_floatbox_insert").find(".tm-tooltip")),i.tmEPOAdmin.tm_weekdays(i("#temp_for_floatbox_insert")),i.tmEPOAdmin.tm_url(),i.tmEPOAdmin.selectbox_price_type(),i.tmEPOAdmin.tm_qty_selector(),i.tmEPOAdmin.tm_pricetype_selector(),i.tmEPOAdmin.addTinyMCE(".flasho.tm_wrapper"),i.tmEPOAdmin.paginattion_init()},logic_check_rules_reindex:function(e,t,n,a,l,o){var r;return"object"==typeof t&&null!==t||(t={}),"toggle"in t||(t.toggle="show"),"what"in t||(t.what="any"),"rules"in t||(t.rules=[]),r=t,n=parseInt(n,10),a=parseInt(a,10),o=parseInt(o,10),i.each(t.rules,function(t,i){var a=i.section,d=i.element;a===l&&d.toString().isNumeric()&&(d=parseInt(d,10),n===d?0===o?(delete r.rules[t],e.addClass("tm-wrong-rule")):1===o&&(d+=1,r.rules[t].element=d.toString()):n<d&&(0===o?(d-=1,r.rules[t].element=d.toString()):1===o&&(d+=1,r.rules[t].element=d.toString())))}),r.rules=i.tm_array_values(r.rules),r},drag_drop:function(e,t,n){var a=i(t.draggable).attr("class").split(/\s+/).filter(function(e){return-1===e.indexOf("element-")?"":-1===e.indexOf("-element-")?e:""}).toString();(a=a.replace(/element-/gi,""))&&i.tmEPOAdmin.builder_clone_element(a,n.closest(".builder_wrapper"))},builder_clone_element:function(e,t,n){var a,l,o,r=i.epoAPI.template.html(b.tc_builder_elements,{});if(r)return n||(n="append"),t=i(t),(a=i(r).filter(".bitem.element-"+e).tcClone(!0))?(a.find(".tm-builder-element-uniqid").val(i.tm_uniqid("",!0)),i(".builder_wrapper").length<=0&&i.tmEPOAdmin.builder_add_section_onClick(),a.addClass("appear"),i.tmEPOAdmin.set_field_title(a),t.find(".bitem_wrapper").find(".ditem").length>0?t.find(".bitem_wrapper").find(".ditem").replaceWith(a):("append"===n&&t.find(".bitem_wrapper").not(".tm-hide").append(a),"prepend"===n&&t.find(".bitem_wrapper").not(".tm-hide").prepend(a)),t.find(".tm_builder_sections").val(function(e,t){return t=parseInt(t,10)+1}),t.find(".tm_builder_section_slides").val(function(){return t.is(".tm-slider-wizard")?t.find(".bitem_wrapper").map(function(e,t){return i(t).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}),a.find(".tm-tabs").tmtabs(),a.find(".tm-header-title").data("id",a),i.tmEPOAdmin.panels_sortable(a.find(".panels_wrap")),"prepend"!==n&&"append"!==n||(l=t.is(".tm-slider-wizard"),o=i.tmEPOAdmin.find_index(l,a),i.tmEPOAdmin.builder_items_sortable_obj.start.section="drag",i.tmEPOAdmin.builder_items_sortable_obj.start.section_eq="drag",i.tmEPOAdmin.builder_items_sortable_obj.start.element="drag",i.tmEPOAdmin.builder_items_sortable_obj.end.section=t.find(".tm-builder-sections-uniqid").val(),i.tmEPOAdmin.builder_items_sortable_obj.end.section_eq=t.index().toString(),i.tmEPOAdmin.builder_items_sortable_obj.end.element=o.toString()),i.tmEPOAdmin.check_element_logic(a),i.tmEPOAdmin.builder_reorder_multiple(),a):void 0},builder_clone_onClick:function(e){var t,n,a,l,o;e.preventDefault(),c(m.i18n_builder_clone)&&(n=(t=i(this).closest(".bitem")).data("original_title"),(a=t.tcClone()).data("original_title",n),a&&(t.after(a),l=a.closest(".builder_wrapper").is(".tm-slider-wizard"),o=i.tmEPOAdmin.find_index(l,a),a.closest(".builder_wrapper").find(".tm_builder_sections").val(function(e,t){return t=parseInt(t,10)+1}),a.closest(".builder_wrapper").find(".tm_builder_section_slides").val(function(){return a.closest(".builder_wrapper").is(".tm-slider-wizard")?a.closest(".builder_wrapper").find(".bitem_wrapper").map(function(e,t){return i(t).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}),a.find(".tm-header-title").data("id",a),a.find(".tm-builder-element-uniqid").val(i.tm_uniqid("",!0)),a.find(".tcpagination").tcPagination("destroy"),i.tmEPOAdmin.builder_clone_after_events(a),i.tmEPOAdmin.builder_reorder_multiple(),i.tmEPOAdmin.builder_items_sortable_obj.start.section="clone",i.tmEPOAdmin.builder_items_sortable_obj.start.section_eq="clone",i.tmEPOAdmin.builder_items_sortable_obj.start.element="clone",i.tmEPOAdmin.builder_items_sortable_obj.end.section=t.closest(".builder_wrapper").find(".tm-builder-sections-uniqid").val(),i.tmEPOAdmin.builder_items_sortable_obj.end.section_eq=t.closest(".builder_wrapper").index().toString(),i.tmEPOAdmin.builder_items_sortable_obj.end.element=o.toString(),i.tmEPOAdmin.logic_reindex()))},builder_section_clone_onClick:function(e){var t,n,a;e.preventDefault(),c(m.i18n_builder_clone)&&(n=(t=i(this).closest(".builder_wrapper")).tcClone())&&(n.find(".tm-builder-sections-uniqid").val(i.tm_uniqid("",!0)),a=[],t.find(".bitem").each(function(e,t){a[e]=i(t).data("original_title")}),t.after(n),n.find(".bitem").each(function(e,t){i(t).data("original_title",a[e]),i(t).find(".tm-header-title").data("id",i(t))}),"slider"===n.find(".section_elements .sections_type").val()&&i.tmEPOAdmin.create_slider(n),i.tmEPOAdmin.builder_reorder_multiple(),i.tmEPOAdmin.builder_items_sortable(n.find(".bitem_wrapper")),i.tmEPOAdmin.builder_clone_after_events(n),n.find(".tm-builder-sections-uniqid").val(i.tm_uniqid("",!0)),i.tmEPOAdmin.check_section_logic(n),i.tmEPOAdmin.check_element_logic(),i.tmEPOAdmin.logic_init(n),n.addClass("appear"))},builder_size:function(){var e=[];return e[0]=["w25","1/4"],e[1]=["w33","1/3"],e[2]=["w50","1/2"],e[3]=["w66","2/3"],e[4]=["w75","3/4"],e[5]=["w100","1/1"],e},builder_floatbox_template:function(e){return i.epoAPI.template.html(d.template("tc-floatbox"),{id:e.id,title:e.title,html:e.html,uniqid:e.uniqid,update:m.i18n_update,cancel:m.i18n_cancel})},builder_floatbox_template_import:function(e){return i.epoAPI.template.html(d.template("tc-floatbox-import"),{id:e.id,title:e.title,html:e.html,cancel:m.i18n_cancel})},id_array:{},_nameAndPropChange:function(e,t){var n,a,l=i(e).attr("name"),o=/\[[0-9]+\]\[\]/g,r=/\[[0-9]+\]/g;null!==l.match(o)?l=l.replace(o,"["+t+"][]"):null!==l.match(r)&&(l=l.replace(r,"["+t+"]")),(n=l.replace(/[\[\]]/g,""))in i.tmEPOAdmin.id_array?i.tmEPOAdmin.id_array[n]=parseInt(i.tmEPOAdmin.id_array[n],10)+1:i.tmEPOAdmin.id_array[n]=0,a=!1,i(e).is(":radio:checked")&&(a=!0),l+="_temp",i(e).attr("name",l),a?i(e).attr("checked","checked").prop("checked",!0):i(e).removeAttr("checked").prop("checked",!1)},_idChange:function(e,t){var n,a=i(e).attr("name"),l=/\[[0-9]+\]\[\]/g,o=/\[[0-9]+\]/g;return null!==a.match(l)?a=a.replace(l,"["+t+"][]"):null!==a.match(o)&&(a=a.replace(o,"["+t+"]")),(n=a.replace(/[\[\]]/g,""))in i.tmEPOAdmin.id_array?i.tmEPOAdmin.id_array[n]=parseInt(i.tmEPOAdmin.id_array[n],10)+1:i.tmEPOAdmin.id_array[n]=0,i(e).attr("id",n+"_"+i.tmEPOAdmin.id_array[n]),a},_idChange2:function(e){var t=i(e).attr("name").replace(/[\[\]]/g,"");t in i.tmEPOAdmin.id_array?i.tmEPOAdmin.id_array[t]=parseInt(i.tmEPOAdmin.id_array[t],10)+1:i.tmEPOAdmin.id_array[t]=0,i(e).attr("id",t+i.tmEPOAdmin.id_array[t])},builder_reorder_multiple:function(){var e,t,n=i(".builder_layout").find('[name^="tm_meta\\[tmfbuilder\\]\\[multiple_"]').map(function(){return i(this).closest(".bitem").attr("class").split(" ").map(function(e){if(-1!==e.indexOf("element-",0))return e}).filter(function(e){if(null!==e&&void 0!==e)return e})}).toArray(),a=[];for(t=0;t<n.length;t+=1)-1===i.inArray(n[t],a)&&a.push(n[t]);i.tmEPOAdmin.id_array={},a.forEach(function(t){(e=i(".builder_layout ."+t)).toArray().forEach(function(e,t){i(e).find(".tm-default-radio").toArray().forEach(function(e){i.tmEPOAdmin._nameAndPropChange(e,t)}),i(e).find("[name]").not(".tm-default-radio").toArray().forEach(function(e){i(e).attr("name",i.tmEPOAdmin._idChange(e,t))})})}),i(".builder_layout").find(".tm-default-radio").each(function(e,t){var n=i(t).attr("name");n=n.replace(/_temp/g,""),i(this).attr("name",n)}),(e=i(".builder_layout").find("[name]").not('[name^="tm_meta\\[tmfbuilder\\]\\[multiple_"]')).toArray().forEach(function(e){i.tmEPOAdmin._idChange2(e)})},builder_clone_after_events:function(e){e.find("input.tm-color-picker").spectrum("destroy"),e.find(".sp-replacer").remove(),i.tmEPOAdmin.panels_sortable(e.find(".panels_wrap")),e.find(".tm-tabs").tmtabs()},gen_events:function(e){e||(e=i(".builder_layout ")),e.find("input.tm-color-picker").spectrum({showInput:!0,showInitial:!0,allowEmpty:!0,showAlpha:!1,showPalette:!1,clickoutFiresChange:!0,showButtons:!1,preferredFormat:"hex"})},paginattion_init:function(e){var t,n,a,l,o=i("#temp_for_floatbox_insert"),r=o.find(".tcpagination");0!==r.length&&(t=o.find(".panels_wrap"),n=t.find(".options_wrap"),a=parseInt(r.attr("data-perpage"),10),l=Math.ceil(n.length/a),r.data("tc-pagination")&&r.tcPagination("destroy"),e="last"===e?l:"current"===e?r.data("pagination_current")||1:1,r.data("pagination_current",e),r.tcPagination({totalPages:l,startPage:e,visiblePages:10,onPageClick:function(e,t){i.tmEPOAdmin.paginationOnClick(r,t,a,n)}}))},paginationOnClick:function(e,t,i,n){var a;for(t=parseInt(t,10),e.data("pagination_current",t),n.addClass("tm-hidden"),a=i*t-1;a>=i*(t-1);a-=1)n.eq(a).removeClass("tm-hidden")},addTinyMCE:function(e){var t,n,d,s,m,c={theme:"modern",menubar:!1,wpautop:!0,indent:!1,toolbar1:"bold,italic,underline,blockquote,strikethrough,bullist,numlist,alignleft,aligncenter,alignright,undo,redo,link,unlink",plugins:"fullscreen,image,wordpress,wpeditimage,wplink"},_={buttons:"strong,em,link,block,del,ins,img,ul,ol,li,code,more,close,fullscreen"},p="object"==typeof a&&"mceInit"in a&&"excerpt"in a.mceInit?a.mceInit.excerpt:c,u="object"==typeof a&&"qtInit"in a&&"excerpt"in a.qtInit?a.qtInit.excerpt:_;i(e)&&void 0!==r&&(s=i("#wp-excerpt-editor-tools").html(),m=i("#wp-excerpt-editor-tools").attr("class"),i(e).find("textarea").not(":disabled").not(".tm-no-editor").each(function(e,c){(n=i(c).attr("id"))&&(t=i.extend({},p,{selector:"#"+n}),d=i.extend({},u,{id:n}),"object"==typeof a&&(a.mceInit[n]=t,a.qtInit[n]=d),i(c).addClass("wp-editor-area").wrap('<div id="wp-'+n+'-wrap" class="wp-core-ui wp-editor-wrap tmce-active tm_editor_wrap"></div>').before('<div class="'+m+'">'+s+"</div>").wrap('<div class="wp-editor-container"></div>'),i(".tm_editor_wrap").find(".wp-switch-editor").each(function(e,t){var a,l,o;i(t).attr("id")&&(l=(a=i(t).attr("id")).length,o=a.substr(l-4),i(t).attr("id",n+"-"+o),i(t).attr("data-wp-editor-id",n))}),i(".tm_editor_wrap").find(".insert-media").attr("data-editor",n),r.init(t),l&&o&&(o(d),l._buttonsInit()),i(c).closest(".tm_editor_wrap").find("a.insert-media").data("editor",n).attr("data-editor",n))}))},removeTinyMCE:function(e){var t,n,a,l="";i(e)&&void 0!==r&&i(e).find("textarea").not(":disabled").not(".tm-no-editor").each(function(e,o){(t=i(o).attr("id"))&&r&&r.editors&&(n=i(o).val(),a=void 0!==r&&r.editors[t]&&!r.editors[t].isHidden(),t in r.editors&&(l=r.editors[t].getContent(),r.editors[t].remove()),i(o).closest(".tm_editor_wrap").find(".quicktags-toolbar,.wp-editor-tools").remove(),i(o).unwrap().unwrap(),a?""===l?i(o).val(""):i(o).val(l):i(o).val(n))})},set_fields_change:function(e){var t;e||(e=i(".builder_textfield_price_type")),0!==i(e).length&&e.each(function(){t=i(this).closest(".builder_element_wrap").find(".builder_price_div"),"currentstep"===i(this).val()?t.length&&t.hide():t.length&&t.show()})},set_field_title:function(e){var t,n;e||(e=i(".bitem")).each(function(e,a){if(0===i(a).find(".tm-header-title").length)return!0;t=i(a),i(a).find(".tm-header-title").data("id",t),void 0!==(n=i(a).find(".tm-header-title").val())&&""!==n&&i(a).find(".tm-label").html(n)}),0!==i(e).length&&e.is(".tm-header-title")&&(n=e.val(),t=e.data("id"),void 0===n||""===n?i(t).find(".tm-label").html("&nbsp;"):i(t).find(".tm-label").html(n))},set_hidden:function(){i(".builder_wrapper").each(function(e,t){var n=i(this);n.find(".tm_builder_sections").val(i(this).find(".bitem ").length),n.find(".tm_builder_section_slides").val(function(){return n.is(".tm-slider-wizard")?n.find(".bitem_wrapper").map(function(e,t){return i(t).children(".bitem").not(".pl2, .element_is_disabled").length}).get().join(","):""}),n.find(".tm_builder_sections_size").val(function(){return i(t).attr("class").split(" ").map(function(e){if(null!==e.match(/w\d+/g))return e}).filter(function(e){if(null!==e&&void 0!==e)return e})[0]}),n.find(".div_size").val(function(){return i(this).closest(".bitem").attr("class").split(" ").map(function(e){if(-1!==e.indexOf("w",0))return e}).filter(function(e){if(null!==e&&void 0!==e)return e})[0]})})},tm_upload_button_remove_onClick:function(){var e=i(this).prevAll("input").first(),t=i(this).nextAll(".tm_upload_image").first().find(".tm_upload_image_img");i(e).val(""),i(t).attr("src","")},variations_display_as:function(e){var t,n,a;(e?i(this).is(".tm-changes-product-image")?i(this).closest(".tm-attribute").find(".variations-display-as"):i(this):i("#temp_for_floatbox_insert .variations-display-as")).each(function(e,l){var o;t=i(l).closest(".tm-attribute"),n=t.find(".tm-term"),a=t.find(".tm-changes-product-image"),"select"===(o=i(l).val())?t.find(".tma-hide-for-select-box").hide().addClass("tm-row-hidden"):t.find(".tma-hide-for-select-box").show().removeClass("tm-row-hidden"),"image"===o||"color"===o||"radiostart"===o||"radioend"===o?t.find(".tma-show-for-swatches").show().removeClass("tm-row-hidden"):t.find(".tma-show-for-swatches").hide().addClass("tm-row-hidden"),n.each(function(e,t){switch(i(t).hide().find(".tma-term-color,.tma-term-image,.tma-term-custom-image").hide(),o){case"select":case"radio":"images"===a.val()&&a.val(""),a.children("option[value='images']").attr("disabled","disabled").hide(),"custom"===a.val()&&i(t).show().find(".tma-term-custom-image").show();break;case"image":case"radiostart":case"radioend":a.children("option[value='images']").removeAttr("disabled").show(),i(t).show().find(".tma-term-image").show(),"custom"===a.val()&&i(t).show().find(".tma-term-custom-image").show();break;case"color":"images"===a.val()&&a.val(""),a.children("option[value='images']").attr("disabled","disabled").hide(),"custom"===a.val()&&i(t).show().find(".tma-term-custom-image").show(),i(t).show().find(".tma-term-color").show()}})})},tm_upload:function(){var e,t,n,a=i("#temp_for_floatbox_insert"),l=a.find(".use_images").not(".tm-changes-product-image"),o=a.find(".use_colors"),r=a.find(".tm-use-images"),d=a.find(".tm-use-colors"),s=a.find(".tm-changes-product-image"),m=a.find(".swatchmode"),c=i("#temp_for_floatbox_insert .tm-show-when-use-images"),_=i("#temp_for_floatbox_insert .tm-show-when-use-color"),p=a.find(".builder_element_wrap").find(".tm_upload_button").not(".tm_upload_buttonp,.tm_upload_buttonl"),u=a.find(".builder_element_wrap").find(".tm_upload_image").not(".tm_upload_imagep,.tm_upload_imagel"),f=a.find(".builder_element_wrap").find(".tm_upload_buttonp"),b=a.find(".builder_element_wrap").find(".tm_upload_imagep"),v=a.find(".builder_element_wrap").find(".tm_upload_buttonl"),h=a.find(".builder_element_wrap").find(".tm_upload_imagel"),g=a.find(".builder_element_wrap").find(".tm_cell_images"),A=a.find(".builder_element_wrap .panels_wrap").find(".sp-replacer");p.hide(),u.hide(),f.hide(),b.hide(),v.hide(),h.hide(),g.hide(),A.hide(),""!==l.val()&&""!==o.val()&&(d.show(),r.show()),""===l.val()&&""===o.val()&&(d.show(),r.show()),""!==l.val()&&""===o.val()&&(d.hide(),r.show()),""===l.val()&&""!==o.val()&&(d.show(),r.hide()),"images"===s.val()&&""===l.val()&&(e=a.find(".tm_option_image").not(".tm_option_imagep"),t=a.find(".tm_option_imagep"),n=a.find(".tm_upload_imagep .tm_upload_image_img"),s.val("custom"),e.each(function(e){t.eq(e).val(i(this).val()),n.attr("src",i(this).val())})),l.length&&"images"===l.val()?s.find("option[value='images']").removeAttr("disabled").show():("images"===s.val()&&s.val(""),s.find("option[value='images']").attr("disabled","disabled").hide()),("images"===l.val()||"start"===l.val()||"end"===l.val()||"images"===l.val()&&"images"===s.val())&&(p.show(),u.show(),g.show()),"custom"===s.val()&&(f.show(),b.show(),g.show()),""!==l.val()?(c.show(),"lightbox"===i("#temp_for_floatbox_insert .tm-use-lightbox").val()&&(v.show(),h.show())):c.hide(),"color"===o.val()?(_.show(),"swatch_img"!==m.val()&&"swatch_img_lbl"!==m.val()&&"swatch_img_desc"!==m.val()&&"swatch_img_lbl_desc"!==m.val()||m.val(""),m.find("option[value='swatch_img']").attr("disabled","disabled").hide(),m.find("option[value='swatch_img_lbl']").attr("disabled","disabled").hide(),m.find("option[value='swatch_img_desc']").attr("disabled","disabled").hide(),m.find("option[value='swatch_img_lbl_desc']").attr("disabled","disabled").hide()):(m.find("option[value='swatch_img']").removeAttr("disabled").show(),m.find("option[value='swatch_img_lbl']").removeAttr("disabled").show(),m.find("option[value='swatch_img_desc']").removeAttr("disabled").show(),m.find("option[value='swatch_img_lbl_desc']").removeAttr("disabled").show(),"images"!==l.val()&&_.hide()),"color"!==o.val()&&"start"!==o.val()&&"end"!==o.val()||(g.show(),A.show())},tm_weekdays:function(e){i(e?e:"body").find(".tm-weekdays").each(function(e,t){var n=i(t).val().split(","),a=i(t).next(".tm-weekdays-picker-wrap");i(a).find(".tm-weekday-picker").each(function(e,t){-1!==n.indexOf(i(t).val())?(i(t).attr("checked","checked").prop("checked",!0),i(t).closest(".tm-weekdays-picker").addClass("tm-checked")):(i(t).removeAttr("checked").prop("checked",!1),i(t).closest(".tm-weekdays-picker").removeClass("tm-checked"))})})},tm_weekday_picker:function(){var e=i(this).closest(".tm-weekdays-picker-wrap").prev(".tm-weekdays"),t=i(e).val().split(","),n=t.indexOf(i(this).val());i(this).is(":checked")?-1===n&&t.push(i(this).val()):-1!==n&&t.splice(n,1),t=i.map(t,function(e){return""===e?null:e}),i(e).val(t.join(",")),i.tmEPOAdmin.tm_weekdays(i(e).parent())},tm_qty_selector:function(e){var t,n;t=i(e?this:"#temp_for_floatbox_insert .tm-qty-selector"),n=i("#temp_for_floatbox_insert").find(".builder_element_wrap").find(".tm-show-for-quantity"),""!==t.val()?n.show():n.hide()},tm_pricetype_selector:function(e){var t,n;t=i(e?this:"#temp_for_floatbox_insert .tm-pricetype-selector"),n=i("#temp_for_floatbox_insert").find(".builder_element_wrap").find(".tm-show-for-per-chars"),"wordnon"===t.val()||"wordpercentnon"===t.val()||"charnon"===t.val()||"charnonnospaces"===t.val()||"charpercentnon"===t.val()||"charpercentnonnospaces"===t.val()?n.show():n.hide()},selectbox_price_type:function(e){var t=i("#temp_for_floatbox_insert"),n=i(e),a=t.find(".builder_element_wrap").find(".tm_option_price_type.multiple_selectbox_options");e||(n=i("#temp_for_floatbox_insert .tm_select_price_type.selectbox")),n.length&&(""===n.val()?a.show():a.hide())},tm_url:function(e){var t=i("#temp_for_floatbox_insert"),n=i(this),a=t.find(".builder_element_wrap").find(".tm_cell_url");e||(n=i("#temp_for_floatbox_insert .use_url")),"url"===n.val()?a.show():a.hide()},upload:function(e){var t,n,a,l;if(e.preventDefault(),!d||!d.media)return!1;t=i(this).prev("input"),n=i(this).nextAll(".tm_upload_image").first().find("img"),t.data("tm_upload_frame")?t.data("tm_upload_frame").open():(a=d.media.controller.Library.extend({defaults:p.defaults({id:"insert-image",title:"Insert Image Url",allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!0,multiple:!0,type:"image"},d.media.controller.Library.prototype.defaults)}),(l=d.media({button:{text:"Select"},state:"insert-image",states:[new a]})).on("close",function(){}),l.on("select",function(){var e=l.state("insert-image"),i=e.get("selection");i&&(n.attr("src",""),t.val(""),i.each(function(i){var a,l=e.display(i).toJSON(),o=i.toJSON(),r=o.caption;d.media.view.settings.captions||delete o.caption,l=d.media.string.props(l,o),a={id:o.id,post_content:o.description,post_excerpt:r},l.linkUrl&&(a.url=l.linkUrl),"image"===o.type?(p.each({align:"align",size:"image-size",alt:"image_alt"},function(e,t){l[t]&&(a[e]=l[t])}),a["image-size"]&&i.attributes.sizes[a["image-size"]]&&(a.url=i.attributes.sizes[a["image-size"]].url)):a.post_title=l.title,n.attr("src",a.url),t.val(a.url)}))}),l.on("open",function(){var e=l.state().get("library").toJSON(),n=!0;i.each(e,function(e,a){var o;a.url===t.val()?(o=d.media.attachment(a.id),l.state().get("selection").add(o?[o]:[]),i(".attachment-display-settings").find("select.size").val("full"),n=!1):a.sizes&&i.each(a.sizes,function(e,r){r.url===t.val()&&(o=d.media.attachment(a.id),l.state().get("selection").add(o?[o]:[]),i(".attachment-display-settings").find("select.size").val(e),n=!1)}),n&&i(".attachment-display-settings").find("select.size").val("full")})}),t.data("tm_upload_frame",l),l.open())}},i(t).ready(function(){var t=i("#bulk-action-selector-top"),d=!1;n=e.woocommerce_admin,a=e.tinyMCEPreInit,l=e.QTags,o=e.quicktags,r=e.tinyMCE,t.length>0&&t.children("option").each(function(e,t){"tcline"===i(t).val()?(d=!0,i(t).replaceWith(i('<optgroup class="tc-bulk-opt" label="'+i(t).text()+'">'))):d&&"tcclear"!==i(t).val()&&"tcproductclear"!==i(t).val()&&"tcclearexclude"!==i(t).val()&&"tcclearexcludeadd"!==i(t).val()&&i(t).appendTo(i(".tc-bulk-opt")),"tcline2"===i(t).val()&&i(t).remove()}),i.tmEPOAdmin.initialitize(),i.tcToolTip()})}(window,document,window.jQuery);